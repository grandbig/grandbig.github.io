<div class="highlight"><pre><span class="err">#</span> <span class="nx">The</span> <span class="nx">fsync</span><span class="p">()</span> <span class="nx">call</span> <span class="nx">tells</span> <span class="nx">the</span> <span class="nx">Operating</span> <span class="nx">System</span> <span class="nx">to</span> <span class="nx">actually</span> <span class="nx">write</span> <span class="nx">data</span> <span class="nx">on</span> <span class="nx">disk</span>
<span class="err">#</span> <span class="nx">instead</span> <span class="nx">to</span> <span class="nx">wait</span> <span class="k">for</span> <span class="nx">more</span> <span class="nx">data</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">output</span> <span class="nx">buffer</span><span class="p">.</span> <span class="nx">Some</span> <span class="nx">OS</span> <span class="nx">will</span> <span class="nx">really</span> <span class="nx">flush</span>
<span class="err">#</span> <span class="nx">data</span> <span class="nx">on</span> <span class="nx">disk</span><span class="p">,</span> <span class="nx">some</span> <span class="nx">other</span> <span class="nx">OS</span> <span class="nx">will</span> <span class="nx">just</span> <span class="k">try</span> <span class="nx">to</span> <span class="k">do</span> <span class="nx">it</span> <span class="nx">ASAP</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nx">Redis</span> <span class="nx">supports</span> <span class="nx">three</span> <span class="nx">different</span> <span class="nx">modes</span><span class="o">:</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nx">no</span><span class="o">:</span> <span class="nx">don</span><span class="err">‘</span><span class="nx">t</span> <span class="nx">fsync</span><span class="p">,</span> <span class="nx">just</span> <span class="kd">let</span> <span class="nx">the</span> <span class="nx">OS</span> <span class="nx">flush</span> <span class="nx">the</span> <span class="nx">data</span> <span class="nx">when</span> <span class="nx">it</span> <span class="nx">wants</span><span class="p">.</span> <span class="nx">Faster</span><span class="p">.</span>
<span class="err">#</span> <span class="nx">always</span><span class="o">:</span> <span class="nx">fsync</span> <span class="nx">after</span> <span class="nx">every</span> <span class="nx">write</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">append</span> <span class="nx">only</span> <span class="nx">log</span> <span class="p">.</span> <span class="nx">Slow</span><span class="p">,</span> <span class="nx">Safest</span><span class="p">.</span>
<span class="err">#</span> <span class="nx">everysec</span><span class="o">:</span> <span class="nx">fsync</span> <span class="nx">only</span> <span class="nx">one</span> <span class="nx">time</span> <span class="nx">every</span> <span class="nx">second</span><span class="p">.</span> <span class="nx">Compromise</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nx">The</span> <span class="k">default</span> <span class="nx">is</span> <span class="s2">&quot;everysec&quot;</span><span class="p">,</span> <span class="nx">as</span> <span class="nx">that</span><span class="err">‘</span><span class="nx">s</span> <span class="nx">usually</span> <span class="nx">the</span> <span class="nx">right</span> <span class="nx">compromise</span> <span class="nx">between</span>
<span class="err">#</span> <span class="nx">speed</span> <span class="nx">and</span> <span class="nx">data</span> <span class="nx">safety</span><span class="p">.</span> <span class="nx">It</span><span class="err">‘</span><span class="nx">s</span> <span class="nx">up</span> <span class="nx">to</span> <span class="nx">you</span> <span class="nx">to</span> <span class="nx">understand</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">relax</span> <span class="k">this</span> <span class="nx">to</span>
<span class="err">#</span> <span class="s2">&quot;no&quot;</span> <span class="nx">that</span> <span class="nx">will</span> <span class="kd">let</span> <span class="nx">the</span> <span class="nx">operating</span> <span class="nx">system</span> <span class="nx">flush</span> <span class="nx">the</span> <span class="nx">output</span> <span class="nx">buffer</span> <span class="nx">when</span>
<span class="err">#</span> <span class="nx">it</span> <span class="nx">wants</span><span class="p">,</span> <span class="k">for</span> <span class="nx">better</span> <span class="nx">performances</span> <span class="p">(</span><span class="nx">but</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">live</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">idea</span> <span class="nx">of</span>
<span class="err">#</span> <span class="nx">some</span> <span class="nx">data</span> <span class="nx">loss</span> <span class="nx">consider</span> <span class="nx">the</span> <span class="k">default</span> <span class="nx">persistence</span> <span class="nx">mode</span> <span class="nx">that</span><span class="err">‘</span><span class="nx">s</span> <span class="nx">snapshotting</span><span class="p">),</span>
<span class="err">#</span> <span class="nx">or</span> <span class="nx">on</span> <span class="nx">the</span> <span class="nx">contrary</span><span class="p">,</span> <span class="nx">use</span> <span class="s2">&quot;always&quot;</span> <span class="nx">that</span><span class="err">‘</span><span class="nx">s</span> <span class="nx">very</span> <span class="nx">slow</span> <span class="nx">but</span> <span class="nx">a</span> <span class="nx">bit</span> <span class="nx">safer</span> <span class="nx">than</span>
<span class="err">#</span> <span class="nx">everysec</span><span class="p">.</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nx">More</span> <span class="nx">details</span> <span class="nx">please</span> <span class="nx">check</span> <span class="nx">the</span> <span class="nx">following</span> <span class="nx">article</span><span class="o">:</span>
<span class="err">#</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//antirez.com/post/redis-persistence-demystified.html</span>
<span class="err">#</span>
<span class="err">#</span> <span class="nx">If</span> <span class="nx">unsure</span><span class="p">,</span> <span class="nx">use</span> <span class="s2">&quot;everysec&quot;</span><span class="p">.</span>

<span class="err">#</span> <span class="nx">appendfsync</span> <span class="nx">always</span>
<span class="nx">appendfsync</span> <span class="nx">everysec</span>
<span class="err">#</span> <span class="nx">appendfsync</span> <span class="nx">no</span>
</pre></div>