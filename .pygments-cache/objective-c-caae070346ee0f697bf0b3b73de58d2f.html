<div class="highlight"><pre><span class="c1">// UIWebView+ProtocolConfirmed.m</span>

<span class="cp">#import &quot;UIWebView+ProtocolConfirmed.h&quot;</span>

<span class="k">@implementation</span> <span class="nc">UIWebView</span><span class="nl">(UIWebView_ProtocolConfirmed)</span>

<span class="c1">// NSURLの取得</span>
<span class="k">-</span> <span class="p">(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nf">URL</span>
<span class="p">{</span>
	<span class="n">NSString</span> <span class="o">*</span><span class="n">URLString</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nl">stringByEvaluatingJavaScriptFromString:</span><span class="s">@&quot;document.URL&quot;</span><span class="p">];</span>
	<span class="k">return</span> <span class="p">[</span><span class="n">NSURL</span> <span class="nl">URLWithString:</span><span class="n">URLString</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// ページのタイトルの取得</span>
<span class="k">-</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">title</span>
<span class="p">{</span>
	 <span class="k">return</span> <span class="p">[</span><span class="n">self</span> <span class="nl">stringByEvaluatingJavaScriptFromString:</span><span class="s">@&quot;document.title&quot;</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// JavaScriptの実行処理</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">evaluateJavaScript:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">javaScriptString</span> <span class="nf">completionHandler:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">id</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="p">))</span><span class="nv">completionHandler</span>
<span class="p">{</span>
	<span class="n">NSString</span> <span class="o">*</span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="nl">stringByEvaluatingJavaScriptFromString:</span><span class="n">javaScriptString</span><span class="p">];</span>
	<span class="k">if</span><span class="p">(</span><span class="n">completionHandler</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">completionHandler</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">nil</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></div>