<div class="highlight"><pre><span class="c1">// main.swift</span>
<span class="n">import</span> <span class="n">PerfectLib</span>
<span class="n">import</span> <span class="n">PerfectHTTP</span>
<span class="n">import</span> <span class="n">PerfectHTTPServer</span>

<span class="c1">// HTTPサーバの生成</span>
<span class="n">let</span> <span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">()</span>

<span class="c1">// リクエストに対するルーティングを設定</span>
<span class="n">var</span> <span class="n">routes</span> <span class="o">=</span> <span class="n">Routes</span><span class="p">()</span>
<span class="n">routes</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="nl">method:</span> <span class="p">.</span><span class="n">get</span><span class="p">,</span> <span class="nl">uri:</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="nl">handler:</span> <span class="p">{</span>
    <span class="n">request</span><span class="p">,</span> <span class="n">response</span> <span class="k">in</span>
    <span class="c1">// レスポンスヘッダーの設定</span>
    <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(.</span><span class="n">contentType</span><span class="p">,</span> <span class="nl">value:</span> <span class="s">&quot;text/html&quot;</span><span class="p">)</span>
    <span class="c1">// レスポンスボディの設定</span>
    <span class="n">response</span><span class="p">.</span><span class="n">appendBody</span><span class="p">(</span><span class="nl">string:</span> <span class="s">&quot;&lt;html&gt;&lt;title&gt;Hello, world!&lt;/title&gt;&lt;body&gt;Hello, world!&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
    <span class="c1">// レスポンス完了処理</span>
    <span class="n">response</span><span class="p">.</span><span class="n">completed</span><span class="p">()</span>
	<span class="p">}</span>
<span class="p">)</span>

<span class="c1">// サーバにルーティング設定を適用</span>
<span class="n">server</span><span class="p">.</span><span class="n">addRoutes</span><span class="p">(</span><span class="n">routes</span><span class="p">)</span>

<span class="c1">// ポートを設定</span>
<span class="n">server</span><span class="p">.</span><span class="n">serverPort</span> <span class="o">=</span> <span class="mi">8181</span>

<span class="c1">// ドキュメントルートのパスを設定</span>
<span class="n">server</span><span class="p">.</span><span class="n">documentRoot</span> <span class="o">=</span> <span class="s">&quot;./webroot&quot;</span>

<span class="c1">// arguments.swiftで定義されているメソッド</span>
<span class="c1">// 更なるサーバ定義が必要な場合はここを見ましょう(SSLなど)</span>
<span class="n">configureServer</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="c1">// HTTPサーバの起動</span>
    <span class="n">try</span> <span class="n">server</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
<span class="p">}</span> <span class="n">catch</span> <span class="n">PerfectError</span><span class="p">.</span><span class="n">networkError</span><span class="p">(</span><span class="n">let</span> <span class="n">err</span><span class="p">,</span> <span class="n">let</span> <span class="n">msg</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="s">&quot;Network error thrown: \(err) \(msg)&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>