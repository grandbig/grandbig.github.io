<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Takahiro Octopress Blog]]></title>
  <link href="http://grandbig.github.io/atom.xml" rel="self"/>
  <link href="http://grandbig.github.io/"/>
  <updated>2016-06-19T23:21:00+09:00</updated>
  <id>http://grandbig.github.io/</id>
  <author>
    <name><![CDATA[Takahiro]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[SwiftとJava8でOptional型を比較してみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/06/19/swift-java-optional/"/>
    <updated>2016-06-19T21:12:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/06/19/swift-java-optional</id>
    <content type="html"><![CDATA[<h4>SwiftとJava8のOptional型を比較してみよう！</h4>

<p>本日はSwiftとJava8のOptional型について比較してみたいと思います。<br/>
最近チラチラとJava8を見かける機会が多いのですが、Swiftと同じくOptional型という概念があるんだ〜と何となく思っていました。<br/>
が、実際に全く同じというわけではないと思うので比較したいと思ったわけです。<br/>
ということで早速見ていきましょう！</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h5>SwiftのOptional型とは</h5>

<p>まずはSwiftのOptional型から見ていきましょう。<br/>
SwiftはObjective-Cでよく発生していた『思いがけず<code>nil</code>が入ったプロパティにアクセスしてExceptionが発生する』という事象を回避できる <strong>Optional型</strong> という概念があります。<br/>
Swiftでは <strong>Optional型</strong> と <strong>非Optional型</strong> を変数定義時に明示的に利用することでこういったExceptionを回避することが可能なのです。</p>

<ul>
<li>Optional型: 変数に<code>nil</code>を代入することを <strong>許容します</strong>

<ul>
<li>Optional型はデータ型の末尾に <strong>『?』</strong> か <strong>『!』</strong> をつけます

<ul>
<li>『?』: 一般的なOptional型です</li>
<li>『!』: 暗黙的Optional型です</li>
</ul>
</li>
</ul>
</li>
<li>非Optional型: 変数に<code>nil</code>を代入することを <strong>許容しません</strong></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// Optional型</span>
</span><span class='line'><span class="n">var</span> <span class="nl">hoge:</span> <span class="n">Int</span><span class="o">?</span>
</span><span class='line'><span class="n">var</span> <span class="nl">fuga:</span> <span class="n">Int</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 非Optional型</span>
</span><span class='line'><span class="n">var</span> <span class="n">piyo</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Optional型から値を取得する方法は</h5>

<p>さて、Optional型の宣言方法は先程話した通りです。<br/>
実際に値を取得する際はOptional型で定義された変数を <strong>アンラップ</strong> する必要があります。</p>

<p>ここで注意したいのが、先に紹介した『!』を使った暗黙的Optional型の場合は <strong>自動的にアンラップする</strong> ので開発者側はアンラップさせる必要がないということです。</p>

<p>アンラップ方法は下記の3通りです。</p>

<ul>
<li>Forced Unwrapping: 変数に『!』をつけます</li>
<li>Optional Binding: <code>if</code>文を利用します</li>
<li>Optional Chaining: 変数に『?』をつけます</li>
</ul>


<p>Forced UnwrappingとOptional Bindeingの例は下記です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">var</span> <span class="nl">hoge:</span> <span class="n">Int</span><span class="o">?</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Forced Unwrapping</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">hoge</span><span class="o">!</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Optional Binding</span>
</span><span class='line'><span class="k">if</span> <span class="n">let</span> <span class="n">fuga</span> <span class="o">=</span> <span class="n">hoge</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">fuga</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>続いてOptional Chainingの例を書きます。<br/>
まずは下記のようなクラスを定義します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">class</span> <span class="nl">Hoge:</span> <span class="n">NSObject</span> <span class="p">{</span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">func</span> <span class="n">hogehoge</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="s">&quot;hogehogeメソッドを実行しました&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>上記で定義したクラスの<code>hogehoge</code>メソッドをOptional Chaningを利用して実行します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">var</span> <span class="nl">hoge:</span> <span class="n">Hoge</span><span class="o">?</span> <span class="o">=</span> <span class="n">Hoge</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Optional Chaining</span>
</span><span class='line'><span class="n">hoge</span><span class="o">?</span><span class="p">.</span><span class="n">hogehoge</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>このようにSwiftではコーディングしていく段階でかなり<code>nil</code>に注意する必要があることがわかります。</p>

<h5>Java8のOptional型とは</h5>

<p>次にJava8のOptional型について見ていきましょう！<br/>
Java8ではOptionalを利用することで</p>

<ul>
<li><code>null</code>の可能性がある変数をラップしておくことで、値を安全に取り出せる</li>
<li>実行したメソッドが<code>null</code>を返却する可能性がある場合に、場合分けを短く書ける</li>
</ul>


<p>というメリットがあります。<br/>
では実際に使い方を見ていきましょう！</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">String</span> <span class="n">hoge</span> <span class="o">=</span> <span class="s">&quot;hoge&quot;</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Optional型にラップする</span>
</span><span class='line'><span class="n">Optional</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">hogeOpt</span> <span class="o">=</span> <span class="n">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">hoge</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Optional型から値を取り出す</span>
</span><span class='line'><span class="c1">// getメソッドを使う</span>
</span><span class='line'><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hogeOpt</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// orElseメソッドを使う</span>
</span><span class='line'><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hogeOpt</span><span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="s">&quot;default data&quot;</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// orElseGetメソッドを使う</span>
</span><span class='line'><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hogeOpt</span><span class="o">.</span><span class="na">orElseGet</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="s">&quot;default data&quot;</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ifPresentメソッドを使う</span>
</span><span class='line'><span class="n">hogeOpt</span><span class="o">.</span><span class="na">ifPresent</span><span class="o">(</span> <span class="n">hoge</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// 値があったときにログ出力</span>
</span><span class='line'>  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hoge</span><span class="o">);</span>
</span><span class='line'><span class="o">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>上記を見ると幾つか値の取得方法があることがわかると思います。<br/>
それぞれSwiftの表記に近しいところがあると感じました。</p>

<p>例えば、<code>get</code>メソッドは値が<code>null</code>だった場合に<code>NoSuchElementException</code>を投げます。<br/>
逆に言えば、確実に<code>null</code>が来ない場合の<code>get</code>メソッドが利用できると言えます。<br/>
これはSwiftで言うところの『Forced Unwrapping』です。</p>

<p><code>orElse</code>や<code>orElseGet</code>はSwiftで言うところのnil合体演算子である『??』を利用しているのとほぼ同等です。<br/>
(Swiftであれば<code>let val = hoge ?? "default data"</code>みたいな感じですね。)</p>

<p><code>ifPresent</code>メソッドもSwiftで言うところの『Optional Binding』と言えるでしょう。</p>

<h4>まとめ</h4>

<p>さて如何でしたでしょうか？<br/>
Android Studio 2.2からJava8のラムダ式サポートなんて話も聞こえてきますし、<br/>
スマートフォンのアプリ開発者は今後、SwiftにもJava8にも関わっていく可能性が十分ありえます。<br/>
そうなったときに学習コストが高いな〜と避けるのではなく、案外触ってみると「あれ！？似てる&hellip;」なんてことがあるかもしれません。<br/>
そんな近未来！？を夢見つつブログを書いてみたのでした。<br/>
ということで今日はここまで。</p>

<p>参考:</p>

<ul>
<li><a href="http://qiita.com/maiki055/items/b24378a3707bd35a31a8">どこよりも分かりやすいSwiftの&#8221;?&ldquo;と&rdquo;!&#8221;</a></li>
<li><a href="http://www.task-notes.com/entry/20150708/1436324400">Java8のOptionalの使い方について</a></li>
</ul>


<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[JekninsからGitHubにアップされたiOSプロジェクトをビルドしよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/06/18/ios-jenkins/"/>
    <updated>2016-06-18T22:57:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/06/18/ios-jenkins</id>
    <content type="html"><![CDATA[<h4>Jenkins / GitHub / Xcodeを連携させよう！</h4>

<p>さて、今日はJenkinsとGitHubとXcodeの連携について見ていきます。<br/>
筆者はこれまで、手元の自身のMac端末でビルドして、Fabricでアプリを配信することが多かったのですが、最近、<a href="https://deploygate.com/?locale=ja">Deploygate</a>を使う場面が出てきました。<br/>
業界スタンダートな方法なのかわからないものの、JenkinsとDeploygateを連携させてJenkins上でビルドしたアプリをDeploygateから配信することができます。<br/>
そういった筆者にとって新しい機会に恵まれたものの、触ってみた経験がないためわからないことが多々あったりします。<br/>
そこで、今回はローカル環境でJenkins / GitHub / Xcodeを連携させて遊んでみようと思います。</p>

<!-- more -->


<h5>Jenkinsのインストール</h5>

<p>まずは、JenkinsをHomebrewでローカル環境にインストールします。<br/>
<code>brew install jenkins</code>を実行します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="nl">Password:</span>
</span><span class='line'><span class="o">==&gt;</span> <span class="n">Downloading</span> <span class="nl">http:</span><span class="c1">//mirrors.jenkins-ci.org/war/2.9/jenkins.war</span>
</span><span class='line'><span class="o">==&gt;</span> <span class="n">Downloading</span> <span class="n">from</span> <span class="nl">http:</span><span class="c1">//ftp.yz.yamagata-u.ac.jp/pub/misc/jenkins/war/2.9/jenkins.war</span>
</span><span class='line'><span class="cp">######################################################################## 100.0%</span>
</span><span class='line'><span class="o">==&gt;</span> <span class="n">jar</span> <span class="n">xvf</span> <span class="n">jenkins</span><span class="p">.</span><span class="n">war</span>
</span><span class='line'><span class="o">==&gt;</span> <span class="n">Caveats</span>
</span><span class='line'><span class="nl">Note:</span> <span class="n">When</span> <span class="n">using</span> <span class="n">launchctl</span> <span class="n">the</span> <span class="n">port</span> <span class="n">will</span> <span class="n">be</span> <span class="mf">8080.</span>
</span><span class='line'>
</span><span class='line'><span class="n">To</span> <span class="n">have</span> <span class="n">launchd</span> <span class="n">start</span> <span class="n">jenkins</span> <span class="n">now</span> <span class="n">and</span> <span class="n">restart</span> <span class="n">at</span> <span class="nl">login:</span>
</span><span class='line'>  <span class="n">brew</span> <span class="n">services</span> <span class="n">start</span> <span class="n">jenkins</span>
</span><span class='line'><span class="n">Or</span><span class="p">,</span> <span class="k">if</span> <span class="n">you</span> <span class="n">don</span><span class="err">&#39;</span><span class="n">t</span> <span class="n">want</span><span class="o">/</span><span class="n">need</span> <span class="n">a</span> <span class="n">background</span> <span class="n">service</span> <span class="n">you</span> <span class="n">can</span> <span class="n">just</span> <span class="nl">run:</span>
</span><span class='line'>    <span class="n">jenkins</span>
</span><span class='line'><span class="o">==&gt;</span> <span class="n">Summary</span>
</span><span class='line'><span class="err">🍺</span>  <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">Cellar</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span><span class="mf">2.9</span><span class="o">:</span> <span class="mi">6</span> <span class="n">files</span><span class="p">,</span> <span class="mf">66.4</span><span class="n">M</span><span class="p">,</span> <span class="n">built</span> <span class="k">in</span> <span class="mi">59</span> <span class="n">seconds</span>
</span></code></pre></td></tr></table></div></figure>


<p>Jenkinsをこれから使う機会も多いかもしれないので自動起動設定もしちゃいましょう。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">cp</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/*</span><span class="p">.</span><span class="n">plist</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">LaunchAgents</span>
</span><span class='line'><span class="n">launchctl</span> <span class="n">load</span> <span class="o">~/</span><span class="n">Library</span><span class="o">/</span><span class="n">LaunchAgents</span><span class="o">/</span><span class="n">homebrew</span><span class="p">.</span><span class="n">mxcl</span><span class="p">.</span><span class="n">jenkins</span><span class="p">.</span><span class="n">plist</span>
</span><span class='line'><span class="n">launchctl</span> <span class="n">start</span> <span class="n">homebrew</span><span class="p">.</span><span class="n">mxcl</span><span class="p">.</span><span class="n">jenkins</span>
</span></code></pre></td></tr></table></div></figure>


<p>本当に起動してるかな〜と心配な方は<code>ps aux | grep jenkins</code>を叩いちゃいましょう！<br/>
すると下記のように表示されます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">java</span> <span class="o">-</span><span class="n">Dmail</span><span class="p">.</span><span class="n">smtp</span><span class="p">.</span><span class="n">starttls</span><span class="p">.</span><span class="n">enable</span><span class="o">=</span><span class="n">true</span> <span class="o">-</span><span class="n">jar</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">jenkins</span><span class="p">.</span><span class="n">war</span> <span class="o">--</span><span class="n">httpListenAddress</span><span class="o">=</span><span class="mf">127.0.0.1</span> <span class="o">--</span><span class="n">httpPort</span><span class="o">=</span><span class="mi">8080</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Jenkinsの初期登録を完了させよう！</h5>

<p>インストール完了したので、Jenkins上でジョブを作りましょう！<br/>
早速、<code>http://localhost:8080</code>にアクセスしてください。</p>

<p>すると、 <strong>Unlock Jenkins</strong> と大きく書かれた画面が表示されます。<br/>
この画面の表示された指示に従って、管理者パスワードを入力しましょう。
(コマンドは画面に表示された通りにターミナルで叩けばOKです。)</p>

<p><img src="http://grandbig.github.io/images/jenkins-1.png" alt="初期画面" /></p>

<p>続いて、 <strong>Customize Jenkins</strong> 画面に遷移するので、<br/>
<strong>Install suggested plugins</strong> を選択しましょう。</p>

<p><img src="http://grandbig.github.io/images/jenkins-2.png" alt="Customize Jenkins" /></p>

<p>そして、ユーザー登録をします。</p>

<p><img src="http://grandbig.github.io/images/jenkins-3.png" alt="ユーザー登録" /></p>

<p>これでJenkinsのトップ画面が表示されます。<br/>
Xcode Pluginがまだインストールされていないので、インストールします。</p>

<p>左メニューから「Jenkinsの管理 > プラグインの管理」を選択します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-6.png" alt="プラグインの管理" /></p>

<p>検索ボックスでXcodeと入力してください。<br/>
<strong>Xcode integration</strong> が見つかりますので、インストールしてください。<br/>
これで必要なプラグインのインストールが完了しました。</p>

<h5>Jenkinsで新規ジョブを作成しよう！</h5>

<p>左メニューから新規ジョブを作成します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-4.png" alt="新規ジョブの作成" /></p>

<p>ジョブ名を入力して、「フリースタイル・プロジェクトのビルド」を選択して、OKを押します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-5.png" alt="ジョブのベースを作成" /></p>

<p>まず、GitHubと連携させましょう。<br/>
JenkinsのジョブにGitのRepository URLを設定します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-7.png" alt="JenkinsでGitのRepository URLを設定" /></p>

<p>ただ単に設定すると403 Errorが出てしまうので、GitHub側を設定します。<br/>
GitHubから取得したいRepositoryを選択します。<br/>
Settings > Webhooks &amp; services > Add Webhook を選択します。<br/>
下記のように設定しましょう！</p>

<p><img src="http://grandbig.github.io/images/jenkins-8.png" alt="Webhooks &amp; services" /></p>

<p>これでJenkins側の403 Errorが解消されるはずです。</p>

<p>続いてビルド情報を入力していきます。</p>

<p>ビルド手順の追加 > 「シェルの実行」を追加します</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cp">#!/bin/bash -l</span>
</span><span class='line'><span class="n">pod</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>


<p>このタイミングで、<code>.bashrc</code>に<code>export LC_ALL="en_US.UTF-8"</code>を追加しておきましょう。<br/>
(追加しないと『 <strong>invalid byte sequence in US-ASCII</strong> 』が後々発生します。)</p>

<p>ビルド手順の追加 > 「Xcode」を追加します<br/>
設定は下記のようにしてきます。</p>

<p>【Code signing &amp; OS X keychain options】</p>

<p><img src="http://grandbig.github.io/images/jenkins-9.png" alt="Code signing &amp; OS X keychain options" /></p>

<p>【Advanced Xcode build options】</p>

<p><img src="http://grandbig.github.io/images/jenkins-10.png" alt="Advanced Xcode build options" /></p>

<table>
<thead>
<tr>
<th></th>
<th align="left">Xcode Schema File: </th>
<th align="center">FacebookLoginSample</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td align="left">Xcode Workspace File: </td>
<td align="center">FacebookLoginSample|</td>
</tr>
<tr>
<td></td>
<td align="left">Xcode Project File: </td>
<td align="center">FacebookLoginSample|</td>
</tr>
<tr>
<td></td>
<td align="left">Build output directory: </td>
<td align="center">${WORKSPACE}/build|</td>
</tr>
</tbody>
</table>


<p>　</p>

<h5>Jennkinsでジョブを実行しよう！</h5>

<p>これでジョブを実行してみましょう！<br/>
左メニューから『 <strong>ビルド実行</strong> 』を選択します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-11.png" alt="ビルド実行" /></p>

<p>ビルドを実行すると、ビルド履歴に新たに項目が追加されます。<br/>
詳しいビルド状況を追いたければ、時間部分を選択します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-12.png" alt="ビルド状況の確認" /></p>

<p>そして、画面遷移後の左メニューから『 <strong>コンソール出力</strong> 』を選択します。</p>

<p><img src="http://grandbig.github.io/images/jenkins-13.png" alt="コンソール出力" /></p>

<p>これで最後までログを追うことができます。</p>

<h4>まとめ</h4>

<p>さて如何でしたでしょうか？<br/>
筆者も初めてローカル環境でJenkinsを立ててみましたが、意外とハマリポイントが多かったです。<br/>
証明書周りでもう少し調べてみたいところもあるので、またわかったことがあればブログに書いていきたいと思います。<br/>
と言ったところで本日はここまで。</p>

<p>参考:</p>

<ul>
<li><a href="http://qiita.com/makoto_kw/items/cbe93d4ebbc35f3b43fd">OS XにJenkinsをHomebrewでセットアップする</a></li>
<li><a href="http://www.buildinsider.net/enterprise/jenkins/001">Jenkinsをインストールして使ってみよう</a></li>
<li><a href="https://github.com/CocoaPods/CocoaPods/issues/639#issuecomment-11483748">invalid byte sequence in US-ASCII</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SwiftとJava8とJavaScriptでreduce / filter / map / flatMap]]></title>
    <link href="http://grandbig.github.io/blog/2016/06/12/filter-map/"/>
    <updated>2016-06-12T21:01:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/06/12/filter-map</id>
    <content type="html"><![CDATA[<h4>SwiftとJava8とJavaScriptを比較してみよう！</h4>

<p>本日は前々から気になっていた『SwiftとJava8とJavaScript』の比較をしてみたいと思います。<br/>
と言っても難しいことをやるわけではなく、今回はreduce, filter, map, flatMapメソッドの書き方を比較してみます。</p>

<p>筆者個人としては、どうしてもSwiftやJava8から書き方やメソッドの意味の理解を始めようとすると時間がかかってしまいます。<br/>
なので、JavaScriptから入って比較することで理解が促進することがあるのです。</p>

<p>では早速見ていきましょう。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>reduceメソッド</h4>

<p>まずは<code>reduce</code>メソッドです。</p>

<h5>JavaScript</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">reduced</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">previus</span><span class="p">,</span> <span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">previous</span> <span class="o">+</span> <span class="nx">current</span><span class="p">;</span>
</span><span class='line'><span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; 15</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Swift</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span><span class='line'><span class="n">let</span> <span class="n">reduced</span> <span class="o">=</span> <span class="n">array</span><span class="p">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">previous</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">previous</span> <span class="o">+</span> <span class="n">current</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; 15</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Java8</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">integerList</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
</span><span class='line'><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">reduce</span><span class="o">((</span><span class="n">previous</span><span class="o">,</span> <span class="n">current</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">previous</span> <span class="o">+</span> <span class="n">current</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; 15</span>
</span></code></pre></td></tr></table></div></figure>


<h4>filterメソッド</h4>

<p>次に<code>filter</code>メソッドです。</p>

<h5>JavaScript</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">44</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">filtered</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">elem</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [50, 800, 44]</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Swift</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">44</span><span class="p">]</span>
</span><span class='line'><span class="n">var</span> <span class="n">filtered</span> <span class="o">=</span> <span class="n">array</span><span class="p">.</span><span class="n">filter</span> <span class="p">{</span> <span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">elem</span> <span class="o">&gt;=</span> <span class="mi">10</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [50, 800, 44]</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Java8</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">50</span><span class="o">,</span> <span class="mi">800</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">44</span><span class="o">);</span>
</span><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">filteredList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
</span><span class='line'><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">elem</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">filteredList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">elem</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [50, 800, 44]</span>
</span></code></pre></td></tr></table></div></figure>


<h4>mapメソッド</h4>

<p>続いて<code>map</code>メソッドです。</p>

<h5>JavaScript</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">mapped</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">elem</span> <span class="o">*</span> <span class="nx">elem</span><span class="p">;</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [1, 4, 9, 16, 25]</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Swift</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span><span class='line'><span class="n">var</span> <span class="n">mapped</span> <span class="o">=</span> <span class="n">array</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">elem</span> <span class="o">*</span> <span class="n">elem</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [1, 4, 9, 16, 25]</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Java8</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
</span><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">mappedList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
</span><span class='line'><span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">elem</span> <span class="o">*</span> <span class="n">elem</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">mappedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">elem</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [1, 4, 9, 16, 25]</span>
</span></code></pre></td></tr></table></div></figure>


<h4>flatMapメソッド</h4>

<p>最後に<code>flatMap</code>メソッドです。<br/>
(と言いつつ、処理の意味的には<code>flatten</code>しか入っていませんね&hellip;)</p>

<h5>JavaScript</h5>

<p>JavaScriptでは標準で<code>flatMap</code>メソッドは実装されていません。<br/>
自作するしかないわけですが、<code>flatMap = flatten + map</code>なので下記のように書けます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">listArrayList</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">flatMappedList</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">concat</span><span class="p">.</span><span class="nx">apply</span><span class="p">([],</span> <span class="nx">listArrayList</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">elem</span><span class="p">;</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [1, 2, 3, 4, 5]</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Swift</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">var</span> <span class="nl">listArrayList:</span><span class="p">[</span><span class="n">Int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'><span class="n">let</span> <span class="nl">list1:</span> <span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span class='line'><span class="n">let</span> <span class="nl">list2:</span> <span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span class='line'><span class="n">let</span> <span class="nl">list3:</span> <span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</span><span class='line'><span class="n">listArrayList</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span>
</span><span class='line'><span class="n">listArrayList</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
</span><span class='line'><span class="n">listArrayList</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">list3</span><span class="p">)</span>
</span><span class='line'>                                              
</span><span class='line'><span class="n">let</span> <span class="n">flatMappedList</span> <span class="o">=</span> <span class="n">listArrayList</span><span class="p">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="k">in</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">elem</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [1, 2, 3, 4, 5]</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Java8</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">listArrayList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;();</span>
</span><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list1</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
</span><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
</span><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list3</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
</span><span class='line'><span class="n">listArrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">list1</span><span class="o">);</span>
</span><span class='line'><span class="n">listArrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">list2</span><span class="o">);</span>
</span><span class='line'><span class="n">listArrayList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">list3</span><span class="o">);</span>
</span><span class='line'><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">flatMappedList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
</span><span class='line'><span class="n">listArrayList</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">flatMap</span><span class="o">(</span><span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">elem</span><span class="o">.</span><span class="na">stream</span><span class="o">()).</span><span class="na">forEach</span><span class="o">(</span><span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">flatMappedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">elem</span><span class="o">));</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 結果 -&gt; [1, 2, 3, 4, 5]</span>
</span></code></pre></td></tr></table></div></figure>


<p>さていかがでしたでしょうか？<br/>
1つの言語を極めれば、何となく他の言語でも書き方がわかるという話を聞いたりすると思うのですが、こういったことの延長戦にある話なんだろうなと思ったりました。<br/>
と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[library not found for -lPods]]></title>
    <link href="http://grandbig.github.io/blog/2016/06/11/cocoapods-error/"/>
    <updated>2016-06-11T22:26:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/06/11/cocoapods-error</id>
    <content type="html"><![CDATA[<h4>library not found for -lPods</h4>

<p>最近このエラーにハマりました。<br/>
CocoaPodsで外部ライブラリをインストールして、いざXcodeプロジェクトを開いてビルドをしてみると&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">linker</span> <span class="n">command</span> <span class="n">failed</span> <span class="n">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
</span><span class='line'><span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">v</span> <span class="n">to</span> <span class="n">see</span> <span class="n">invocation</span><span class="p">)</span>
</span><span class='line'><span class="nl">ld:</span> <span class="n">library</span> <span class="n">not</span> <span class="n">found</span> <span class="k">for</span> <span class="o">-</span><span class="n">lPods</span>
</span></code></pre></td></tr></table></div></figure>




<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<p>なんてエラーが発生して失敗してしまいました。<br/>
はっきり言って、このエラー内容を見ても、<br/>
『CocoaPodsで取り込んだはずのライブラリが見つけられていない』<br/>
ということしかわかりません。</p>

<p>結局どう解決したかというと&hellip;<br/>
プロジェクト内に含まれる<code>libPods.a</code>と<code>libPods-XXX.a</code> (XXX: Target名)を全て削除しました。<br/>
削除しても<code>pod install</code>で問題なくこれらファイルは復活するのでご安心を。</p>

<p>どうも、これらファイルが残った状態だと<code>pod install</code>しても新たにファイルが上書きされるわけではないようなんです。</p>

<p>チーム開発するときはGitに古い<code>libPods.a</code>, <code>libPods-XXX.a</code>が上がっていないか十分に注意しましょう。<br/>
心配な場合は<code>.gitignore</code>に<code>*.xcworkspace</code>と共に<code>libPods.a</code>, <code>libPods-XXX.a</code>を記載しておくのも手かもしれません。</p>

<p>と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CocoaPods v1.0.0のメモ]]></title>
    <link href="http://grandbig.github.io/blog/2016/06/04/cocoapods-v1-dot-0/"/>
    <updated>2016-06-04T22:26:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/06/04/cocoapods-v1-dot-0</id>
    <content type="html"><![CDATA[<h4>CocoaPodsをv1.0.0にしたらエラーが出てしまった！</h4>

<p>さて、本日はメモ書きです。<br/>
先日、筆者はCocoaPodsのバージョンを <strong>1.0.0</strong> にアップデートしました。<br/>
で、早速、<code>pod install</code>を実行してみたところ、下記のようなエラーが&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="n">he</span> <span class="n">dependency</span> <span class="err">`</span><span class="n">AFNetworking</span> <span class="p">(</span><span class="o">~&gt;</span> <span class="mf">2.6.3</span><span class="p">)</span><span class="err">`</span> <span class="n">is</span> <span class="n">not</span> <span class="n">used</span> <span class="k">in</span> <span class="n">any</span> <span class="n">concrete</span> <span class="n">target</span><span class="p">.</span>
</span><span class='line'><span class="n">The</span> <span class="n">dependency</span> <span class="err">`</span><span class="n">CocoaLumberjack</span> <span class="p">(</span><span class="o">~&gt;</span> <span class="mf">1.9.2</span><span class="p">)</span><span class="err">`</span> <span class="n">is</span> <span class="n">not</span> <span class="n">used</span> <span class="k">in</span> <span class="n">any</span> <span class="n">concrete</span> <span class="n">target</span><span class="p">.</span>
</span><span class='line'><span class="n">The</span> <span class="n">dependency</span> <span class="err">`</span><span class="n">MagicalRecord</span> <span class="p">(</span><span class="o">~&gt;</span> <span class="mf">2.3.2</span><span class="p">)</span><span class="err">`</span> <span class="n">is</span> <span class="n">not</span> <span class="n">used</span> <span class="k">in</span> <span class="n">any</span> <span class="n">concrete</span> <span class="n">target</span><span class="p">.</span>
</span><span class='line'><span class="p">...</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->




<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


<p>おっと、何だ何だ？？となったわけですが、ググってみたらすぐにわかりました。<br/>
どうやら、Targetにインストール対象を定義することがMUSTになったようなのです。</p>

<p>よって、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">AFNetworking</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.6.3</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">CocoaLumberjack</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">1.9.2</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">MagicalRecord</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.3.2</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>と書いていたものを</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">MyProject</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">AFNetworking</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.6.3</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">CocoaLumberjack</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">1.9.2</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">MagicalRecord</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.3.2</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">MyProjectTests</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">AFNetworking</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.6.3</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">CocoaLumberjack</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">1.9.2</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">MagicalRecord</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.3.2</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">MyProjectUITests</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">AFNetworking</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.6.3</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">CocoaLumberjack</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">1.9.2</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">MagicalRecord</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.3.2</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>のように具体的に指定することが必要となります。<br/>
しかし、共通しているインストール対象を何度も書くのは無駄なので&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">def</span> <span class="n">common_pods</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">AFNetworking</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.6.3</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">CocoaLumberjack</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">1.9.2</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">MagicalRecord</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span><span class="mf">2.3.2</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">MyProject</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">common_pods</span>
</span><span class='line'><span class="n">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">MyProjectTests</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">common_pods</span>
</span><span class='line'><span class="n">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">MyProjectUITests</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">common_pods</span>
</span><span class='line'><span class="n">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>と簡略化することができます。便利ですね！<br/>
ということで今更かつ簡単なメモ書きでした。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spring Bootでリダイレクト先にパラメータを渡す方法]]></title>
    <link href="http://grandbig.github.io/blog/2016/05/28/redirect-parameter-spring-boot/"/>
    <updated>2016-05-28T20:39:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/05/28/redirect-parameter-spring-boot</id>
    <content type="html"><![CDATA[<h4>RedirectAttributesを使ってみよう！</h4>

<p>さて、本日は久々にSpring Bootの話です。</p>

<p>皆さんはWebアプリケーションを作る中で、「リダイレクト先にパラメータを渡したい！」なんてことはありませんでしょうか？<br/>
筆者は先日、そのような状況に鉢合わせたのですが、ググってみてもなかなか求めている答えが見つからず、少々悩んでしまいました。<br/>
GETリクエストであればリダイレクト後にURLからリクエストパラメータが取得できますが、<br/>
POSTリクエストやURLにリクエストパラメータを表示するわけにいかない仕様の場合はそうもいきません。</p>

<p>そんなときに役に立つのが<code>RedirectAttributes</code>です。<br/>
では、早速、使い方を見ていきましょう。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


<!-- more -->


<h4>リダイレクト先に文字列を送る</h4>

<p>まずは単純な例から見ていきましょう。<br/>
下記はリダイレクト先に文字列をパラメータとして渡す例です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// HelloController</span>
</span><span class='line'><span class="nd">@Controller</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="o">{</span>
</span><span class='line'>  <span class="nd">@RequestMappinf</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">form</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttributes</span><span class="o">,</span> <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      
</span><span class='line'>      <span class="n">redirectAttributes</span><span class="o">.</span><span class="na">addFlashSttribute</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;redirect:/redirectSample&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;/redirectSample&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">sample</span><span class="o">(</span><span class="nd">@ModelAttributes</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      
</span><span class='line'>      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;name: &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;sample&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>実際に動かしてみれば、正しくログが出力されることを確認できるでしょう。<br/>
上記で<code>return "sample";</code>としているのは単なる例なので、適切なtemplateを指定してあげてください。</p>

<h4>リダイレクト先にオブジェクトを送る</h4>

<p>続いて、パラメータをまとめて送るパターンです。<br/>
今回は下記のように定義された<code>MyData</code>を送ってみましょう。<br/>
※ソースを簡単にするために<code>build.gradle</code>に<code>compile("org.projectlombok:lombok:1.16.6")</code>を設定して<code>@Data</code>を利用しています。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// MyData.java</span>
</span><span class='line'><span class="nd">@Data</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyData</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">memo</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>では、実際にパラメータを送ってみましょう。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// HelloController</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@Controller</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">form</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttributes</span><span class="o">,</span> <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;memo&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">memo</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      
</span><span class='line'>      <span class="c1">// MyDataについては後述します</span>
</span><span class='line'>      <span class="n">MyData</span> <span class="n">mydata</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyData</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">memo</span><span class="o">);</span>
</span><span class='line'>      <span class="n">ModelMap</span> <span class="n">modelMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ModelMap</span><span class="o">();</span>
</span><span class='line'>      <span class="n">modelMap</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;mydata&quot;</span><span class="o">,</span> <span class="n">mydata</span><span class="o">);</span>
</span><span class='line'>      <span class="n">redirectAttributes</span><span class="o">.</span><span class="na">addFlashAttribute</span><span class="o">(</span><span class="s">&quot;model&quot;</span><span class="o">,</span> <span class="n">modelMap</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;redirect:/redirectSample&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;/redirectSample&quot;</span><span class="o">)</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">sample</span><span class="o">(</span><span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;model&quot;</span><span class="o">)</span><span class="n">ModelMap</span> <span class="n">modelMap</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      
</span><span class='line'>      <span class="n">MyData</span> <span class="n">mydata</span> <span class="o">=</span> <span class="n">modelMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;mydata&quot;</span><span class="o">);</span>
</span><span class='line'>      <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
</span><span class='line'>      <span class="n">String</span> <span class="n">memo</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="na">getMemo</span><span class="o">();</span>
</span><span class='line'>      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;name: &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;, memo: &quot;</span> <span class="o">+</span> <span class="n">memo</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;sample&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>オブジェクトとしてパラメータを送るには<code>ModelMap</code>に一度格納する必要があります。<br/>
パラメータを受け取ったあとに型変換して取り出せばOKです。</p>

<h4>RedirectAttributesにおけるaddAttributeとaddFlashAttributeの違い</h4>

<p>さて、今回は<code>RedirectAttributes</code>の<code>addFlashAttribute</code>を利用しましたが、<code>RedirectAttributes</code>には<code>addAttribute</code>というメソッドも存在します。<br/>
ではなぜ<code>addFlashAttribute</code>を利用したのか参考までに書いておきます。</p>

<h5>RedirectAttributesのaddAttributeはリダイレクト先に文字列としてパラメータを送る</h5>

<p>大きな違いは<code>addFlashAttribute</code>のように<code>ModelMap</code>型でパラメータを送れません。<br/>
よって、複数のパラメータを送るには1つずつパラメータをセットするしか方法がありません。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// addAttributeの例</span>
</span><span class='line'><span class="n">redirectAttributes</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="s">&quot;hogehoge&quot;</span><span class="o">);</span>
</span><span class='line'><span class="n">redirectAttributes</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;memo&quot;</span><span class="o">,</span> <span class="s">&quot;fugafuga&quot;</span><span class="o">);</span>
</span></code></pre></td></tr></table></div></figure>


<h5>RedirectAttributesのaddAttributeはリダイレクト先でのパラメータの受取り方が異なる</h5>

<p>こちらも大きな違いとなりますが、<code>addFlashAttribute</code>のときのように<code>@ModelAttribute</code>を使ってパラメータを受け取ることができません。<br/>
<code>addAttribute</code>の場合、<code>@RequestParameter</code>を使ってパラメータを受取ります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// addAttributeの例</span>
</span><span class='line'><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;/redirectSample&quot;</span><span class="o">)</span>
</span><span class='line'><span class="kd">public</span> <span class="n">String</span> <span class="nf">sample</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;memo&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">memo</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">...</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h5>リロード時の挙動が異なる</h5>

<p>最後になりますが、<br/>
<code>addAttribute</code>と<code>addFlashAttribute</code>ではリダイレクト後にリロードすると挙動が異なります。<br/>
<code>addAttribute</code>ではGETリクエストとしてURLの末尾に<code>?name=hogehoge&amp;memo=fugafuga</code>という形でパラメータが渡されるため、リロードをしてもパラメータを受け取ることができます。</p>

<p>しかし、<code>addFlashAttribute</code>では<code>flashMap</code>を利用したパラメータ渡しとなっています。<br/>
よって、リダイレクト後は<code>flashMap</code>からパラメータが残らないため、何もパラメータを受け取ることはできなくなります。</p>

<p>いかがでしたでしょうか？<br/>
筆者にとってもSpring Bootに慣れない日々が続きますが、気づいたことや学んだことについてはブログにまとめていきたと思います。<br/>
と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Bolts-Swiftを使ってみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/05/15/bolts-swift/"/>
    <updated>2016-05-15T22:34:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/05/15/bolts-swift</id>
    <content type="html"><![CDATA[<h4>SwiftでBolts-Swiftライブラリを使ってみよう</h4>

<p>これまで、<code>BrightFuture</code>, <code>PromiseKit</code>とPromiseライブラリについて見てきましたが、本日はFacebook製のPromiseライブラリである<a href="https://github.com/BoltsFramework/Bolts-Swift">Bolts-Swift</a>を試してみたいと思います。</p>

<p><code>Bolts</code>はこれまでもObjective-Cコードで利用されてきた有名ライブラリですが、<br/>
2016-03-18にSwift版 v1.0.0(<code>Bolts-Swift</code>) が公開されました。<br/>
※ Objective-C版は<a href="https://github.com/BoltsFramework/Bolts-ObjC">Bolts-ObjC</a>です。<br/>
※ 本記事執筆時点ではv1.1.0が最新となっています。</p>

<p>Facebookのエンジニアが開発しているため、Facebook SDKを利用する場合でも内部で<code>Bolts-ObjC</code>が利用されています。<br/>
現在、Facebook SDKがObjective-Cで書かれているため、今後Swift化される際に、<code>Bolts-Swift</code>が使われることになる可能性が高いと思います。<br/>
知っておいて損はないでしょう。</p>

<p>ということで早速、使い方を見ていきましょう。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>Bolts-Swiftのインストール</h4>

<p>CocoaPodsでインストールします。</p>

<p><strong>1．Podfileに下記を記載</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">source</span> <span class="err">&#39;</span><span class="nl">https:</span><span class="c1">//github.com/CocoaPods/Specs.git&#39;</span>
</span><span class='line'><span class="n">platform</span> <span class="o">:</span><span class="n">ios</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">8.0</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">use_frameworks</span><span class="o">!</span>     <span class="c1">// (1)</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="s">&quot;BoltsSwiftSample&quot;</span> <span class="k">do</span>   <span class="c1">// (2)</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">Bolts</span><span class="o">-</span><span class="n">Swift</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Bolts-Swift</code>の場合は(1)と(2)が必須書式となります。<br/>
(書かない場合、インストール時にErrorが発生します。)</p>

<p><strong>2．<code>pod install</code>を実行</strong></p>

<p><strong>3．処理の実装</strong></p>

<p>ライブラリのインストールが完了したら、処理を書いていきましょう。</p>

<p><code>Bolts-Swift</code>を適用したメソッドを用意します。<br/>
※ 非同期処理を含むサンプルメソッドです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">func</span> <span class="n">p_task</span><span class="p">(</span><span class="nl">msg:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Task</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">let</span> <span class="n">taskCompletionSource</span> <span class="o">=</span> <span class="n">TaskCompletionSource</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">()</span>
</span><span class='line'>  <span class="n">let</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="n">dispatch_sync</span><span class="p">(</span><span class="n">dispatch_get_main_queue</span><span class="p">(),</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>          <span class="n">taskCompletionSource</span><span class="p">.</span><span class="n">setResult</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>                          
</span><span class='line'>  <span class="k">return</span> <span class="n">taskCompletionSource</span><span class="p">.</span><span class="n">task</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>このように定義することで、下記のように呼び出すことが可能となります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">bt</span> <span class="o">=</span> <span class="n">BoltsTask</span><span class="p">()</span>
</span><span class='line'><span class="n">bt</span><span class="p">.</span><span class="n">p_task</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">).</span><span class="n">continueOnSuccessWith</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Task</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="k">in</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">bt</span><span class="p">.</span><span class="n">p_task</span><span class="p">(</span><span class="s">&quot;Good Evening&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}.</span><span class="n">continueOnSuccessWith</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Task</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="k">in</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">bt</span><span class="p">.</span><span class="n">p_task</span><span class="p">(</span><span class="s">&quot;Good Bye&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>これを実行すれば、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Hello</span>
</span><span class='line'><span class="n">Good</span> <span class="n">Evening</span>
</span><span class='line'><span class="n">Good</span> <span class="n">Bye</span>
</span></code></pre></td></tr></table></div></figure>


<p>と結果が得られます。<br/>
以上のように『ネストを浅く』、『非同期処理を直列的に書く』ことができます。</p>

<p><code>BrightFuture</code>や<code>PromiseKit</code>を試しに使ってきたことで思ったのが、同様の書式で書けることが多いということです。<br/>
一見、GitHub上のReadmeを読んでもわからないと思うライブラリがあった際には、用途が似ているライブラリのReadmeを見てみるのも1つの手段かもしれません。</p>

<p>といったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SwiftでFacebookログインを始めよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/05/14/facebook-login-for-swift/"/>
    <updated>2016-05-14T15:30:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/05/14/facebook-login-for-swift</id>
    <content type="html"><![CDATA[<h4>Facebookログインの実装方法</h4>

<p>公式ページの<a href="https://developers.facebook.com/">facebook for developers</a>を見るのが、一番良いと思いますが、<br/>
あちこちページを飛ばされるので、順を追って説明することにします。<br/>
※ 本記事で利用しているFacebook SDKは <strong>v4.11.0</strong> です。</p>

<p><strong>1．Facebookログインを選択する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_1.png" alt="Facebookログインを選択" /></p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<p><strong>2．Get Startedを選択する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_2.png" alt="Get Startedを選択" /></p>

<p><strong>3．iOSを選択する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_3.png" alt="iOSを選択" /></p>

<p><strong>4．利用手順の概要を読む</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_4.png" alt="利用手順の概要を読む" /></p>

<p><strong>5．Facebookアプリを作成する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_5.png" alt="Facebookアプリを作成" /></p>

<p>※ CocoaPodsでFacebook SDKを取り込むので、ダウンロードはしません。</p>

<p>「新しいアプリを作成」を選択すると、アプリ作成画面が表示されるため、任意の値を入力してください。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_6.png" alt="任意の値を入力" /></p>

<p><strong>6．作成したFacebookアプリにiOSアプリ用の設定を追加する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_7.png" alt="一連のiOSアプリ用設定手順" /></p>

<p><img src="http://grandbig.github.io/images/facebook_login_8.png" alt="追加ボタンを選択" /></p>

<p><img src="http://grandbig.github.io/images/facebook_login_9.png" alt="iOSを選択" /></p>

<p>追加された設定項目に値を入力して、「変更を保存」ボタンを選択します。</p>

<ul>
<li>バンドルIDを入力</li>
<li>シングルサインオンボタンをONに変更</li>
</ul>


<p><img src="http://grandbig.github.io/images/facebook_login_10.png" alt="設定項目に値を入力" /></p>

<p>続いて、詳細設定でネイティブアプリでの利用を許可します。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_18.png" alt="詳細設定" /></p>

<p><strong>7．Xcodeプロジェクトを用意する</strong></p>

<p>当然のことながら、Xcodeプロジェクトを作成します。</p>

<p><strong>8．<code>Podfile</code>を作成する</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">source</span> <span class="err">&#39;</span><span class="nl">https:</span><span class="c1">//github.com/CocoaPods/Specs.git&#39;</span>
</span><span class='line'><span class="n">platform</span> <span class="o">:</span><span class="n">ios</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">8.0</span><span class="err">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="cp"># Facebook</span>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">FBSDKCoreKit</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">FBSDKLoginKit</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">FBSDKShareKit</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>9．<code>pod install</code>を実行する</strong></p>

<p><strong>10．Xcodeプロジェクトに必要な設定を追加</strong></p>

<p>必要な設定値を見るために、<br/>
下図のようにFacebookアプリページのiOS設定項目上の <strong>クイックスタート</strong> を選択します。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_11.png" alt="クイックスタートを選択" /></p>

<p>すると、下図のページに遷移します。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_12.png" alt="クイックスタートページ" /></p>

<p>この中で重要なのが <strong>Configure your info.plist</strong> です。<br/>
ここに書かれた設定値をXcodeに追加します。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_13.png" alt="Configure your info.plist" /></p>

<p><img src="http://grandbig.github.io/images/facebook_login_14.png" alt="Xcodeに設定値を追加" /></p>

<p><strong>11．XcodeプロジェクトにiOS9 SDK対応の設定を追加</strong></p>

<p>iOS9 SDKよりHTTP通信が非推奨となったため、ATS設定を追加する必要があります。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_15.png" alt="XcodeにATS設定を追加" /></p>

<p><strong>12．Facebookアプリをホワイトリストに追加する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_16.png" alt="ホワイトリストへの追加" /></p>

<p><strong>13．Bridge-Headerファイルを追加</strong></p>

<p>Swift実装なので、Bridge-Headerファイルを追加します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// FacebookLoginSample-Bridging-Header.h</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#ifndef FacebookLoginSample_Bridging_Header_h</span>
</span><span class='line'><span class="cp">#define FacebookLoginSample_Bridging_Header_h</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#import &lt;FBSDKCoreKit/FBSDKCoreKit.h&gt;</span>
</span><span class='line'><span class="cp">#import &lt;FBSDKLoginKit/FBSDKLoginKit.h&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="cp">#endif </span><span class="cm">/* FacebookLoginSample_Bridging_Header_h */</span><span class="cp"></span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>14．<code>AppDelegate.swift</code>に<code>FBSDKApplicationDelegate</code>への接続処理を追加</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// AppDelegate.swift</span>
</span><span class='line'>
</span><span class='line'><span class="n">func</span> <span class="n">application</span><span class="p">(</span><span class="nl">application:</span> <span class="n">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nl">launchOptions:</span> <span class="p">[</span><span class="nl">NSObject:</span> <span class="n">AnyObject</span><span class="p">]</span><span class="o">?</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">FBSDKApplicationDelegate</span><span class="p">.</span><span class="n">sharedInstance</span><span class="p">().</span><span class="n">application</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nl">didFinishLaunchingWithOptions:</span> <span class="n">launchOptions</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">true</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">func</span> <span class="n">application</span><span class="p">(</span><span class="nl">application:</span> <span class="n">UIApplication</span><span class="p">,</span> <span class="n">openURL</span> <span class="nl">url:</span> <span class="n">NSURL</span><span class="p">,</span> <span class="nl">sourceApplication:</span> <span class="n">String</span><span class="o">?</span><span class="p">,</span> <span class="nl">annotation:</span> <span class="n">AnyObject</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Bool</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="n">FBSDKApplicationDelegate</span><span class="p">.</span><span class="n">sharedInstance</span><span class="p">().</span><span class="n">application</span><span class="p">(</span><span class="n">application</span><span class="p">,</span>
</span><span class='line'>                                                               <span class="nl">openURL:</span> <span class="n">url</span><span class="p">,</span>
</span><span class='line'>                                                               <span class="nl">sourceApplication:</span> <span class="n">sourceApplication</span><span class="p">,</span>
</span><span class='line'>                                                               <span class="nl">annotation:</span> <span class="n">annotation</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>15．Facebook SDKが機能しているか確認</strong></p>

<p>Facebook SDKを搭載したつもりでも、一切機能していないと困りますよね？<br/>
ということでログ収集機能を使ってTestできたりします。<br/>
様々なログ収集が可能なようですが、公式ページにあるように最も簡単なアプリ起動ログ収集を実装します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// AppDelegate.swift</span>
</span><span class='line'><span class="n">func</span> <span class="nf">applicationDidBecomeActive</span><span class="p">(</span><span class="nl">application:</span> <span class="n">UIApplication</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">FBSDKAppEvents</span><span class="p">.</span><span class="n">activateApp</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://www.facebook.com/analytics?__aref_src=devsite&amp;__aref_id=docs_ios_getting_started">アプリ用Analyticsダッシュボード</a>に遷移します。<br/>
ログを確認したいアプリ > アクティビティー > イベントを選択します。<br/>
すると「App Launches」の件数を確認することができます。</p>

<p><strong>16．ログインボタンを追加</strong></p>

<p>公式ではソースコードから追加しているので、その想定で書いていますが、もちろんStoryboardも利用できます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// ViewController.swift</span>
</span><span class='line'><span class="n">import</span> <span class="n">UIKit</span>
</span><span class='line'>
</span><span class='line'><span class="n">class</span> <span class="nl">ViewController:</span> <span class="n">UIViewController</span><span class="p">,</span> <span class="n">FBSDKLoginButtonDelegate</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">override</span> <span class="n">func</span> <span class="n">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">super</span><span class="p">.</span><span class="n">viewDidLoad</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">let</span> <span class="n">loginBtn</span> <span class="o">:</span> <span class="n">FBSDKLoginButton</span> <span class="o">=</span> <span class="n">FBSDKLoginButton</span><span class="p">()</span>
</span><span class='line'>      <span class="n">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">addSubview</span><span class="p">(</span><span class="n">loginBtn</span><span class="p">)</span>
</span><span class='line'>      <span class="n">loginBtn</span><span class="p">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">center</span>
</span><span class='line'>      <span class="n">loginBtn</span><span class="p">.</span><span class="n">readPermissions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;public_profile&quot;</span><span class="p">,</span> <span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="s">&quot;user_friends&quot;</span><span class="p">]</span>
</span><span class='line'>      <span class="n">loginBtn</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">self</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">func</span> <span class="n">loginButton</span><span class="p">(</span><span class="nl">loginButton:</span> <span class="n">FBSDKLoginButton</span><span class="o">!</span><span class="p">,</span> <span class="n">didCompleteWithResult</span> <span class="nl">result:</span> <span class="n">FBSDKLoginManagerLoginResult</span><span class="o">!</span><span class="p">,</span> <span class="nl">error:</span> <span class="n">NSError</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="s">&quot;ログイン処理を実行&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// エラーが発生した場合</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="s">&quot;Process Error !&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="n">isCancelled</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// ログインをキャンセルした場合</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="s">&quot;User Cancelled&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// その他</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="s">&quot;Login Succeeded&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">func</span> <span class="n">loginButtonDidLogOut</span><span class="p">(</span><span class="nl">loginButton:</span> <span class="n">FBSDKLoginButton</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="s">&quot;ログアウト処理を実行&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>結果、下図のような遷移が可能となります。</p>

<p><img src="http://grandbig.github.io/images/facebook_login_17.png" alt="Facebookログイン" /></p>

<h4>Facebookログインボタンのカスタム化</h4>

<p>因みに、Facebookログインボタンをカスタム化する方法を説明します。<br/>
折角なので、Storyboardでの方法として載せておきましょう。</p>

<p><strong>1．Storyboardにボタンを配置する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_19.png" alt="Storyboardにボタンを配置" /></p>

<p><strong>2．StoryboardからViewControllerにボタンアクションを接続する</strong></p>

<p><img src="http://grandbig.github.io/images/facebook_login_20.png" alt="ボタンアクションの接続" /><br/>
※ 上記キャプチャでは既に下記3の処理を書いてあるけど悪しからず&hellip;</p>

<p><strong>3．ログインアクションを追加</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// ViewController.swift</span>
</span><span class='line'><span class="err">@</span><span class="kt">IBAction</span> <span class="n">func</span> <span class="n">loginByFacebookID</span><span class="p">(</span><span class="nl">sender:</span> <span class="n">AnyObject</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">let</span> <span class="nl">loginManager:</span> <span class="n">FBSDKLoginManager</span> <span class="o">=</span> <span class="n">FBSDKLoginManager</span><span class="p">()</span>
</span><span class='line'>  <span class="n">loginManager</span><span class="p">.</span><span class="n">logInWithReadPermissions</span><span class="p">([</span><span class="s">&quot;public_profile&quot;</span><span class="p">,</span> <span class="s">&quot;email&quot;</span><span class="p">,</span> <span class="s">&quot;user_friends&quot;</span><span class="p">],</span> <span class="nl">fromViewController:</span> <span class="n">self</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="c1">// エラーが発生した場合</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="s">&quot;Process error&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="n">isCancelled</span> <span class="p">{</span>
</span><span class='line'>          <span class="c1">// ログインをキャンセルした場合</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="s">&quot;Cancelled&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="c1">// その他</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="s">&quot;Login Succeeded&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>さて、いかがでしたでしょうか？<br/>
Facebook SDKも徐々にバージョンアップしていますので、なかなか最新のライブラリに対応した記事がないこともあるでしょう。<br/>
そんなときに本記事を少しでも参考にしてもらえればと思います。<br/>
ということで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Freddyを使ってみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/05/08/freddy/"/>
    <updated>2016-05-08T22:47:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/05/08/freddy</id>
    <content type="html"><![CDATA[<h4>SwiftでJSONパーサーライブラリを使ってみよう</h4>

<p>GW最終日にブログを更新します。<br/>
以前、<a href="http://grandbig.github.io/blog/2016/03/06/swiftyjson/">今更だけど使ってみようSwiftyJson</a>で紹介しましたが、今回は別のSwift製のJSONパーサーライブラリを紹介したいと思います。<br/>
本日は、<a href="https://github.com/bignerdranch/Freddy">Freddy</a>というJSONパーサーライブラリを紹介します。<br/>
SwiftyJsonのGitHub上でのStar数が約1万なのに比べるとFreddyは約850と段違いに支持数は低いですが、割りと有名なライブラリかと思います。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>CocoaPodsでインストール</h4>

<p>まずはインストールです。<br/>
今回も<code>Open Weather Map API</code>をサンプルに利用したいので<a href="https://github.com/Alamofire/Alamofire">Alamofire</a>も合わせてインストールします。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">source</span> <span class="err">&#39;</span><span class="nl">https:</span><span class="c1">//github.com/CocoaPods/Specs.git&#39;</span>
</span><span class='line'><span class="n">platform</span> <span class="o">:</span><span class="n">ios</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">8.0</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">use_frameworks</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">Freddy</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">Alamofire</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">3.0</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Freddyを使ってみる</h4>

<p>続いて、早速<code>Freddy</code>を使ってみましょう。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">do</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">let</span> <span class="n">json</span> <span class="o">=</span> <span class="n">try</span> <span class="n">JSON</span><span class="p">(</span><span class="nl">data:</span> <span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="o">!</span><span class="p">)</span>
</span><span class='line'>              <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">try</span> <span class="n">json</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="s">&quot;weather&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;description&quot;</span><span class="p">]</span>
</span><span class='line'>              <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
</span><span class='line'>          <span class="p">}</span> <span class="n">catch</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">print</span><span class="p">(</span><span class="s">&quot;例外が発生しました！&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>SwiftyJson</code>では下記のように書いていました。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">value</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">let</span> <span class="n">json</span> <span class="o">=</span> <span class="n">JSON</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;description&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Freddy</code>と<code>SwiftyJson</code>を比較すると、そこまで大きな違いはないと思います。<br/>
<code>Freddy</code>の場合は、</p>

<ul>
<li>JSON型への変換に失敗した場合、throwで例外を投げる</li>
<li>JSON型データ内のデータ形式次第で実行するメソッドが変わる<br/>
<code>array</code>, <code>string</code>, <code>bool</code>等のメソッドを使うことでアンラップを気にする必要がなくなります。</li>
</ul>


<p>といった特徴があります。<br/>
どのライブラリを使った方が良いか否かは個々人の判断ですね。</p>

<p>簡単ですが、本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[快適なSpring BootプログラミングのためにIntelliJ IDEA Ultimate版を購入しよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/30/start-spring-boot-intellij-ultimate/"/>
    <updated>2016-04-30T14:48:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/30/start-spring-boot-intellij-ultimate</id>
    <content type="html"><![CDATA[<h4>はじめに</h4>

<p>筆者は決してJetBrains社の回し者ではありません笑<br/>
最近、Spring Bootにチャレンジしているのですが、自宅ではvimを使っていました。<br/>
なぜかって、IntelliJ IDEA Community版だとSpring Bootプログラミングの際に面倒なことが多いんですもの&hellip;。<br/>
しかしながら、vimでSpring Bootプログラミングを続けるのもしんどいので、<br/>
とうとうIntelliJ IDEA Ultimate版に手を出してしまったということなんです。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>IntelliJ IDEA Ultimate版とは</h4>

<p>さて、早速、IntelliJ IDEA Ultimate版の何が良いかについて説明していきます。<br/>
IntelliJ IDEAとは<a href="https://www.jetbrains.com/">JetBrains</a>社が開発した多言語対応の統合開発環境のことです。<br/>
Android StudioがIntelliJ IDEAを元に作られていることは割りと有名な話ですね。</p>

<p>筆者が<a href="http://grandbig.github.io/blog/2016/04/16/start-spring-boot/">Spring Bootを使い始めよう！</a>の記事内で使用していたIntelliJ IDEAはCommunity版だったのですが、<br/>
もちろん、Community版でもプログラミングを書くことやGradleによるビルド実行は問題ありません。<br/>
しかし、Community版では例えば下記のようなことに対応できません。</p>

<ul>
<li>Spring Boot Framework関連の予測変換</li>
<li>Thymeleaf関連の予測変換</li>
<li>Spring Bootを利用したプロジェクトをIntelliJから新規作成可能</li>
</ul>


<p>これに対応したのが <strong>IntelliJ IDEA Ultimate版</strong> なのです。<br/>
詳細は公式サイトから知ることができます。</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate1.png" alt="IntelliJ 比較表" /></p>

<p>また、価格ですが、個人版であれば、ビジネス版よりも比較的に安く購入することができます。<br/>
1年単位での購入なのですが、使い続けるほどに安くなるという価格設定がエンジニア魂をくすぐります。<br/>
下図のように、3年目以降は初年度の半額弱にまで安くなります。<br/>
(Apple Developer Programも同じような仕組みにして欲しいですね笑)</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate2.png" alt="IntelliJ IDEA Ultimate版の価格" /></p>

<p>因みに、同ページに「All Products Pack」という商品もありますが、<br/>
PHP, Ruby等々を無双したい方向けなので、筆者には今のところ不要です。</p>

<h4>IntelliJ IDEA Ultimate版の購入と設定</h4>

<p>IntelliJ IDEA Ultimate版の購入方法と設定について説明します。<br/>
購入は非常に簡単です。</p>

<p>1．<a href="https://www.jetbrains.com/idea/buy/#edition=personal">Buyページ</a>で <strong>Buy Now</strong> をクリック</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate2.png" alt="Buyページ" /></p>

<p>2．CustomerページでEmailアドレスを入力してNEXTをクリック</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate3.png" alt="Customerページ" /></p>

<p>3．Emailアドレスと国を確認してPROCESS AS NEW CUSTOMERをクリック</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate4.png" alt="Customerページ2" /></p>

<p>4．Customer Infoページで必要事項を入力してPLACE ORDERをクリック</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate5.png" alt="Customer Infoページ" /></p>

<p>5．JetBrains社から届いたメールの添付ファイルを開封して、リンクをクリックしてActivationページへ遷移</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate6.png" alt="JetBrains社から届いたメールの添付ファイル" /></p>

<p>6．Activationページを確認</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate7.png" alt="Activationページ" /></p>

<p>ここまでで、購入完了したことを確認できます。<br/>
続いて設定に必要な工程について説明します。</p>

<p>7．ActivationページでDownload activation codeをクリック</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate8.png" alt="Activationページ2" /></p>

<p>8．IntelliJ IDEA Ultimate版をDownLoad</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate9.png" alt="Ultimate版をDownLoad" /></p>

<p>9．Activation codeをIntelliJ IDEA Ultimate版に登録</p>

<p>DownLoadしたIntelliJ IDEA Ultimate版を起動して、先ほどDownLoadしたActivation codeを設定しましょう。</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate10.png" alt="IntelliJ IDEA Ultimate" /></p>

<p>以上で設定も完了です。</p>

<h4>IntelliJ IDEA Ultimate版でSpring Bootを始めよう！</h4>

<p>では、IntelliJ IDEA Ultimate版でSpring Bootを利用する新規プロジェクトを作成しましょう。</p>

<p>1．IntelliJ IDEA Ultimate版を起動してCreate New Projectをクリック</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate11.png" alt="Create New Project" /></p>

<p>2．Spring Inilializrを選択</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate12.png" alt="Spring Initializr" /></p>

<p>3．各種名称や項目を設定</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate13.png" alt="各種名称や項目の設定" /></p>

<p>4．必要なDependencyを設定</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate14.png" alt="必要な名称や項目の設定" /></p>

<p>5．プロジェクト名と保存場所を設定</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate15.png" alt="プロジェクト名と保存場所を設定" /></p>

<p>6．Gradleの設定の確認</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate16.png" alt="Gradleの設定の確認" /></p>

<p>以上で新規プロジェクトが作成できました。<br/>
プロジェクトを実行してみましょう。</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot-intellij-ultimate17.png" alt="プロジェクトの実行" /></p>

<p>さて、如何でしたでしょうか？<br/>
非常に簡単に導入できますし、使い勝手も良いので、これからSpring Bootプログラミングを始める方は検討してみてはいかがでしょうか？<br/>
と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tokyo Server-Side Swift Meetup #2 に行ってきました！]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/21/server-side-swift-meetup-2/"/>
    <updated>2016-04-21T19:24:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/21/server-side-swift-meetup-2</id>
    <content type="html"><![CDATA[<h3>Tokyo Server-Side Swift Meetup #2</h3>

<p>今日は久しぶりに勉強会に行ってきた話です。<br/>
今日行ってきた勉強会は<a href="http://tokyo-ss-swift.connpass.com/event/29240/">Tokyo Server-Side Swift Meetup #2</a>です。<br/>
筆者はSwiftでサーバサイドを書けるようになるとAppleが発表してからというもの、Swift3.0の公開を心待ちにしていました。<br/>
いざ、GitHubで公開された瞬間は何とも言えない感動を覚えました。</p>

<p>時は流れ&hellip;筆者は未だにSwift3.0を全く触っていません！<br/>
日々、世の中で公開されるサーバサイドSwift関連の情報も全然追いきれていません&hellip;<br/>
これはマズイということでまずは形だけでも参加してみることにしました。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<p>ということで勉強会のメモ書きです。</p>

<h3>Swiftプロトコル指向なCのラッパーを作る</h3>

<p><a href="https://speakerdeck.com/yusukeito/swift-purotokoruzhi-xiang-nacfalseratupawozuo-ru">資料のリンク</a></p>

<ul>
<li>CoreAudio→Swiftからたたくと問題があった

<ul>
<li>APIはC言語</li>
<li>AVFoundation系を叩くことが多いので、直接使う機会はあまりないかも</li>
<li>C言語でのサンプルを紹介</li>
<li>C言語は辛い, 1箇所でも間違えると落ちる・辛い</li>
<li>AudioObjectGetPropertyData, AudioObjectSetPropertyData</li>
</ul>
</li>
<li>Swiftでは入力の方に対応する出力の型として表現できる(Protocolのassociated-type)</li>
<li><a href="http://github.com/novi/HALAudio">HALAudio</a>

<ul>
<li>Core AudioはPrefixが特殊なのでわかりにくい</li>
<li>C言語よりSwiftの方がエラーハンドリングが楽(try-catchを使えるから)</li>
</ul>
</li>
<li>プロトコルの場合の制約

<ul>
<li>コンストラクタのある型(class, struct, enum)を一連の制約の中に入れることができない</li>
<li>プロトコル自体に値は持たせられない</li>
</ul>
</li>
</ul>


<h3>The Ecosystem of Web Development with Swift</h3>

<p><a href="https://speakerdeck.com/takebayashi/the-ecosystem-of-web-development-with-swift">資料のリンク</a></p>

<ul>
<li>Web Applicationを開発する上で使うツール

<ul>
<li>Web Application Framework</li>
<li>Web Application Servers etc</li>
</ul>
</li>
<li>FrameworkとServerの選び方

<ul>
<li>Framework

<ul>
<li><a href="https://github.com/PerfectlySoft/Perfect">PerfectLib</a>

<ul>
<li>2015/11に発表</li>
<li>オーソドックスな形で使える</li>
<li>PerfectServerModuleInitという名前は固定(癖がある)</li>
<li>デプロイがしんどい</li>
</ul>
</li>
<li><a href="https://github.com/IBM-Swift/Kitura">Kitura</a>

<ul>
<li>IBM製</li>
<li>2016/02に発表</li>
<li>至って普通の書き方</li>
<li>PerfectLibよりもシンプル！</li>
<li>Kitura-netでKitura Appはデプロイできる</li>
<li>サーバとFrameworkが密になり過ぎている</li>
<li>PerfectLibをKitura-netで使うことはできない</li>
<li>サーバとFrameworkは疎結合であるべき</li>
<li>Python: WSGI, Perl: PSGI, Ruby: Rack

<ul>
<li>サーバとFrameworkが疎結合で好きに組み合わせることができる</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://github.com/nestproject/Nest">Nest</a>

<ul>
<li>WSGIとかのSwift版</li>
<li>Swift Protocolの</li>
<li>非常にシンプル</li>
<li>Nest.swift1個だけ</li>
<li><a href="https://github.com/necolt/Swifton">Swifton</a>, <a href="https://github.com/nestproject/Frank">Frank</a>はNestをサポートしている</li>
<li><a href="https://github.com/kylef/Curassow/blob/master/docs/index.rst">Curassow</a>, <a href="https://github.com/takebayashi/http4swift">http4swift</a>はNestをサポートしている

<ul>
<li>http4swiftはオススメしない</li>
</ul>
</li>
<li><a href="https://github.com/nestproject/Inquiline">Inquiline</a>でちょっと楽に</li>
<li>Applicationの部分を変更せずにサーバを変えられる</li>
<li>Nest Tools: <a href="https://github.com/nestproject/NestTest">NestTest</a>, <a href="https://github.com/nestproject/NestTestSuite">NestTestSuite</a></li>
</ul>
</li>
<li><a href="https://github.com/open-swift">Open-Swft</a>

<ul>
<li>Cross project standards for Swift</li>
<li>先週まではSwiftXという名前だった</li>
<li><a href="https://github.com/open-swift/C7">C7(Component)</a>, <a href="https://github.com/open-swift/S4">S4(Server-Side)</a>, <a href="https://github.com/open-swift/D5">D5</a>

<ul>
<li>C7: Data, Stream, URIなどの基本的なデータ構造を提供</li>
<li>S4: Server-Side Swift StandardsなのでS4

<ul>
<li>More Swifty</li>
<li>Nestの競合(PSGIとかのSwift版)</li>
<li>NestよりもSwiftっぽい</li>
<li>非同期/同期をIFレベルで対応</li>
<li>S4はサーバ側も仕様が決まっている

<ul>
<li><a href="https://github.com/qutheory/vapor">Vapor</a>, <a href="https://github.com/Zewo/Zewo">Zewo</a>, <a href="https://github.com/noppoMan/Slimane">Slimane: Frameworks Supporting S4</a></li>
<li><a href="https://github.com/VeniceX/Venice">VeniceX</a>, <a href="https://github.com/noppoMan/Skelton">Skelton: Servers Supporting S4</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Slackチャンネルがある</li>
</ul>
</li>
<li>Nest vs S4

<ul>
<li>Community: S4の方が活発, NestはCommunityが死んでる</li>
<li>API: Nestは安定している, S4はAPIがころころ変わる</li>
<li>Spec: Nestはシンプル(画面1個に収まる), S4は複雑(C7をベースにしているから)</li>
<li>開発時は好きな方を選んでOK</li>
<li>Nestで実装されたものが多いが、S4はこれから良くなる</li>
<li>好きなFrameworkを選んで、それに対応した好きなサーバを選ぶ</li>
<li>NestでApp, S4でサーバしたい場合はアダプタを自作しましょう</li>
</ul>
</li>
<li>PerfectLibは使わないで!</li>
</ul>
</li>
</ul>
</li>
</ul>


<h3>Up to Simane 0.2 and the Server Side Swift Standards</h3>

<p><a href="https://speakerdeck.com/noppoman/up-to-slimane-0-dot-2-and-the-server-side-swift-standards">資料のリンク</a></p>

<ul>
<li>Slimane

<ul>
<li>Slimane開発者</li>
<li>Express inspireしたFramework</li>
<li>超軽量</li>
<li>完全に非同期</li>
<li>超高速</li>
<li>モジュール化されています</li>
<li>マルチプロセスで動く</li>
<li>Swift3.0サポートしている(Swift2.2は動かない)</li>
<li>Open-Swiftを採用している</li>
<li>常に最新を追いかける思想で開発します</li>
<li>SUV: Swift Wrapper for libuv</li>
<li>Skelton: Stream based tiny Asynchronous HTTP Server</li>
</ul>
</li>
<li>0.1から結構変更した

<ul>
<li>極力頑張ってExpressっぽく書けるようにしている</li>
</ul>
</li>
<li>Open-Swift

<ul>
<li>開発がめちゃ速い(次の日はCompileが通らない&hellip;)</li>
<li>forkして、そのバージョンを使うようにしている</li>
<li>SwiftonがNestからOpen-Swiftに移行するかも？</li>
</ul>
</li>
<li>Slimaneでの書き方

<ul>
<li>めっちゃExpressっぽい</li>
<li>RESTful APIの書き方とか&hellip;</li>
<li>RouterもMiddlewareもExpressっぽい&hellip;</li>
<li>Session

<ul>
<li>Redisを使ったSession Storeの例を紹介</li>
</ul>
</li>
<li>Slimane.Static

<ul>
<li>今はバグっているので、すぐに直します！</li>
</ul>
</li>
<li>BodyParser

<ul>
<li>application/json, application/x-www-form-urlencoding</li>
</ul>
</li>
<li>Response with Template Engine

<ul>
<li>MustacheViewEngine</li>
</ul>
</li>
<li>Renderable Protocol

<ul>
<li>ReactのView EngineをSwiftで作る夢</li>
<li>夢であって、現実には存在しない</li>
</ul>
</li>
<li>Cluster

<ul>
<li>シングルスレッドをコア数分、展開する</li>
<li>書き方はNode.jsライク</li>
<li>Node.jsのClusterモジュールを真似て作った</li>
</ul>
</li>
<li>IPC between the Master and the Workers</li>
<li>Let it crash

<ul>
<li>メモリが80%こえたらRestartするといったAppの作り方ができる</li>
<li>プロセス管理ができる</li>
</ul>
</li>
<li>DataBase

<ul>
<li>Slimaneには今はない</li>
<li>MySql-Swiftがすごく良い

<ul>
<li>SlimaneはNo Blocking I/Oだからダメ&hellip;</li>
</ul>
</li>
</ul>
</li>
<li>Process.qwork

<ul>
<li>Blocking I/OをNo Blocking I/Oに見せかける</li>
<li>Synchronous I/O</li>
</ul>
</li>
<li>パフォーマンス

<ul>
<li>ABテストをやってみた</li>
<li>Slimaneが動くバージョンで試してみた</li>
<li>Swiftのバージョンによって動かないFrameworkは多い</li>
<li>Nginxは早過ぎる&hellip;</li>
<li>Expressより相当Slimaneは速い(Swiftが速いことが証明された)</li>
<li>REVELよりもVAPORの方が速い(Swiftが速いことを証明)</li>
</ul>
</li>
<li>Slimaneの今後

<ul>
<li>Promise対応必須</li>
<li>Stream Response</li>
<li>MySqlをネイティブ非同期で通信</li>
<li>Command line IF</li>
<li>Test Codes</li>
<li>Webフロントとの親和性を高めたい</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>今日は以上です。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spring BootでSystem.inにハマったメモ]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/17/gradle-spring-boot/"/>
    <updated>2016-04-17T23:13:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/17/gradle-spring-boot</id>
    <content type="html"><![CDATA[<h4>Spring BootをGradleでビルドしてハマったメモ</h4>

<p>今日は超絶ハマって苦しんだ超初歩についてメモ書きです。<br/>
Spring Bootに関する情報はあまり多くはないのですが、<br/>
さらに困ったことにほとんどの書籍やネット情報ではMavenでビルドしているのでGradleに関する情報が乏しくてハマりました&hellip;。</p>

<p>Javaでキーボード入力のために、<br/>
<code>Scanner scanner = new Scanner(System.in);</code>を記述することがあります。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<p>これをメインファイルに記述した状態で<code>gradle bootRun</code>コマンドを実行しても、<br/>
しれっと処理が流れてしまいました&hellip;。<br/>
「なぜだ〜〜〜」と格闘すること数時間!?</p>

<p>解決方法がわかりました。下記を<code>build.gradle</code>に追加します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// build.gradle</span>
</span><span class='line'><span class="n">bootRun</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">standardInput</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">in</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>これは<code>bootRun</code>タスクを実行したときに、<br/>
<code>System.in</code>をInput処理として判別するように定義しています。<br/>
もう一度<code>gradle bootRun</code>を実行してみると処理が途中でStopしてユーザ入力を受け付けるようになりました。</p>

<p>いや〜ハマった&hellip;。<br/>
本日は完全なるメモ書きでした。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spring BootでHello Worldをしてみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/17/hello-world-spring-boot/"/>
    <updated>2016-04-17T01:25:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/17/hello-world-spring-boot</id>
    <content type="html"><![CDATA[<h4>Spring BootでHello World</h4>

<p>引き続きSpring Bootの練習です。<br/>
前回、Spring Boot用のプロジェクトを作成して、起動してみるところまでやってみました。<br/>
今回はHello Worldアプリケーションを作成してみます。<br/>
(Node.jsのExpressとは異なりますが、結構簡単にできました。)</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<p>まずは、下記が前回のフォルダ構成です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">firstApp</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">build</span><span class="o">.</span><span class="na">gradle</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">gradlew</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">gradlew</span><span class="o">.</span><span class="na">bat</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">gradle</span>
</span><span class='line'>  <span class="err">┃</span>    <span class="err">┗━━</span> <span class="n">wrapper</span>
</span><span class='line'>  <span class="err">┃</span>          <span class="err">┣━━</span> <span class="n">gradle</span><span class="o">-</span><span class="n">wrapper</span><span class="o">.</span><span class="na">jar</span>
</span><span class='line'>  <span class="err">┃</span>          <span class="err">┗━━</span> <span class="n">gradle</span><span class="o">-</span><span class="n">wrapper</span><span class="o">.</span><span class="na">properties</span>
</span><span class='line'>  <span class="err">┗━━</span> <span class="n">src</span>
</span><span class='line'>       <span class="err">┣━━</span> <span class="n">main</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┣━━</span> <span class="n">java</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┃</span>    <span class="err">┗━━</span> <span class="n">com</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┃</span>         <span class="err">┗━━</span> <span class="n">example</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┃</span>               <span class="err">┗━━</span> <span class="n">FirstAppApplication</span><span class="o">.</span><span class="na">java</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┗━━</span> <span class="n">resources</span>
</span><span class='line'>       <span class="err">┃</span>         <span class="err">┗━━</span> <span class="n">application</span><span class="o">.</span><span class="na">properties</span>
</span><span class='line'>       <span class="err">┗━━</span> <span class="n">test</span>
</span><span class='line'>            <span class="err">┗━━</span> <span class="n">java</span>
</span><span class='line'>                 <span class="err">┗━━</span> <span class="n">com</span>
</span><span class='line'>                      <span class="err">┗━━</span> <span class="n">example</span>
</span><span class='line'>                            <span class="err">┗━━</span> <span class="n">FirstAppApplicationTests</span><span class="o">.</span><span class="na">java</span>
</span></code></pre></td></tr></table></div></figure>


<p>今回はWebアプリケーションを作成するので、<code>build.gradle</code>を修正する必要があります。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// build.gradle</span>
</span><span class='line'><span class="n">dependencies</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">compile</span> <span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">web</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">testCompile</span><span class="o">(</span><span class="err">&#39;</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">test</span><span class="err">&#39;</span><span class="o">)</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>コンパイル対象のSpring Bootのモジュールを変更しています。<br/>
(元はcompile(&lsquo;org.springframework.boot:spring-boot-starter&rsquo;)でした。)</p>

<p>次に、上記のフォルダ構成の<code>FirstApplication.java</code>と同階層に<code>HelloController.java</code>を作成します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// HelloController.java</span>
</span><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@RestController</span>
</span><span class='line'><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;/hello-world&quot;</span><span class="o">)</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="o">{</span>
</span><span class='line'>  <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">method</span><span class="o">=</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;Hello Spring MVC&quot;</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>HelloController.java</code>の処理について説明すると</p>

<ul>
<li><code>@RestController</code>: WebAPIのエントリポイントクラスを指定</li>
<li><code>@RequestMapping</code>: パスやHTTPメソッド(GET, POST, PUT, DELETEなど)のマッピングを指定

<ul>
<li><code>@RequestMapping("/hello-world")</code>で<code>HelloController</code>クラスにパスをマッピング</li>
<li><code>@RequestMapping(method=RequestMethod.GET)</code>で<code>hello</code>メソッドにHTTPメソッドをマッピング</li>
</ul>
</li>
</ul>


<p>そして、<code>application.properties</code>にポート番号を指定します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// application.properties</span>
</span><span class='line'><span class="n">server</span><span class="o">.</span><span class="na">port</span><span class="o">=</span><span class="mi">9000</span>
</span></code></pre></td></tr></table></div></figure>


<p>あとは、ターミナルから<code>gradle bootRun</code>を実行するだけです。<br/>
そして、Chromeで<code>http://localhost:9000/hello-world</code>にアクセスしてみましょう。<br/>
下記のような結果が得られるはずです。</p>

<p><img src="http://grandbig.github.io/images/hello-world-spring-boot1.png" alt="Hello World" /></p>

<p>もろもろの問題はあるけれど、後回しにして、引き続き勉強を進めます。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spring Bootを使い始めよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/16/start-spring-boot/"/>
    <updated>2016-04-16T14:43:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/16/start-spring-boot</id>
    <content type="html"><![CDATA[<h4>Spring Bootとは</h4>

<p>本日はこれまでと全く趣向を変えて、 <strong>Spring Boot</strong> について書きたいと思います。<br/>
<a href="http://projects.spring.io/spring-boot/">Spring Boot</a>とはSpringプロジェクトが提供している多くのFrameworkを統合した、<br/>
簡単にWebアプリケーションを作成できるように設計されたFrameworkです。</p>

<p>開発者はSpringプロジェクト内で用意された様々なFrameworkを意識する必要がありません。<br/>
Spring Bootとは長年ブラッシュアップされ、肥大化してきたSpringプロジェクトへの参入ハードルを劇的に下げるものと言えるでしょう。</p>

<p>なんて言いつつも、<br/>
筆者はJavaによるWebアプリケーション開発はほとんどやったことがありません。</p>

<p>何はともあれ、まずは触れてみたいと思います。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>Spring BootによるWeb Application Projectを作成しよう！</h4>

<p>最も簡単な方法について説明します。</p>

<p>1．<a href="https://start.spring.io/">Spring Initializr</a>にアクセス<br/>
Projectの自動生成ツールサイトがあるので、アクセスして各種項目を設定しましょう。</p>

<ul>
<li>Project: GradleおよびMavenから選択できます</li>
<li>Spring Boot: バージョンを選択できます</li>
<li>Group: パッケージ名を指定できます</li>
<li>Artifact: メインファイル名を指定できます</li>
<li>Dependencies: 初期状態で追加されるdependenciesを指定できます</li>
</ul>


<p>筆者は下記のように指定しました。</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot1.png" alt="Spring Initializr" /></p>

<p>2．Generate Projectボタンをクリック<br/>
下記のようなProjectが生成されます。<br/>
(下記は筆者が指定した設定項目で生成されたProjectです。)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">firstApp</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">build</span><span class="o">.</span><span class="na">gradle</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">gradlew</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">gradlew</span><span class="o">.</span><span class="na">bat</span>
</span><span class='line'>  <span class="err">┣━━</span> <span class="n">gradle</span>
</span><span class='line'>  <span class="err">┃</span>    <span class="err">┗━━</span> <span class="n">wrapper</span>
</span><span class='line'>  <span class="err">┃</span>          <span class="err">┣━━</span> <span class="n">gradle</span><span class="o">-</span><span class="n">wrapper</span><span class="o">.</span><span class="na">jar</span>
</span><span class='line'>  <span class="err">┃</span>          <span class="err">┗━━</span> <span class="n">gradle</span><span class="o">-</span><span class="n">wrapper</span><span class="o">.</span><span class="na">properties</span>
</span><span class='line'>  <span class="err">┗━━</span> <span class="n">src</span>
</span><span class='line'>       <span class="err">┣━━</span> <span class="n">main</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┣━━</span> <span class="n">java</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┃</span>    <span class="err">┗━━</span> <span class="n">com</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┃</span>         <span class="err">┗━━</span> <span class="n">example</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┃</span>               <span class="err">┗━━</span> <span class="n">FirstAppApplication</span><span class="o">.</span><span class="na">java</span>
</span><span class='line'>       <span class="err">┃</span>    <span class="err">┗━━</span> <span class="n">resources</span>
</span><span class='line'>       <span class="err">┃</span>         <span class="err">┗━━</span> <span class="n">application</span><span class="o">.</span><span class="na">properties</span>
</span><span class='line'>       <span class="err">┗━━</span> <span class="n">test</span>
</span><span class='line'>            <span class="err">┗━━</span> <span class="n">java</span>
</span><span class='line'>                 <span class="err">┗━━</span> <span class="n">com</span>
</span><span class='line'>                      <span class="err">┗━━</span> <span class="n">example</span>
</span><span class='line'>                            <span class="err">┗━━</span> <span class="n">FirstAppApplicationTests</span><span class="o">.</span><span class="na">java</span>
</span></code></pre></td></tr></table></div></figure>


<p>3．<code>gradle bootRun</code>コマンドを実行<br/>
firstApp直下で<code>gradle bootRun</code>コマンドを実行します。<br/>
下記のような実行結果が出るはずです。</p>

<p><img src="http://grandbig.github.io/images/start-spring-boot2.png" alt="実行結果" /></p>

<p>これは生成されたメインファイルでのソースが下記のようになっているためです。<br/>
<code>main</code>メソッド内で実行している処理はたったの1行で、<br/>
これはSpring Bootによるアプリケーションを起動する処理となっています。</p>

<p>ここで設定している<code>@SpringBootApplication</code>アノテーションは<br/>
<code>@Configuration</code>, <code>@EnableAutoConfiguration</code>, <code>@ComponentScan</code>の3つの設定と同義になります。</p>

<ul>
<li><code>@Configuration</code>: Beanを含むJavaConfig用のクラスに付与する</li>
<li><code>@EnableAutoConfiguration</code>: 様々な設定を自動で有効にする</li>
<li><code>@ComponentScan</code>: クラスの自動スキャンを可能にする</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@SpringBootApplication</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FirstAppApplication</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">FirstAppApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>因みに、初期状態で<code>sourceCompatibility</code>および<code>targetCompatibility</code>が <strong>1.8</strong> となっています。<br/>
よって、実行するためにはJDKバージョン <strong>1.8</strong> が必要になります。<br/>
(インストールは<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">こちら</a>から)</p>

<p>まずは最も簡単な導入が完了したようです。</p>

<h4>IntelliJ IDEAにimportしてみよう</h4>

<p>ターミナルからプロジェクトの開発を続けても良いのですが、<br/>
ターミナルに慣れていない方は統合開発環境ツールで開きたいかもしれませんね。<br/>
複雑なプロジェクトになればなるほど、ターミナルでの開発は辛くなるかもしれません。</p>

<p>ということでIntelliJ IDEAに先ほどのプロジェクトをimportしてみましょう。</p>

<p>1．IntelliJ IDEAを起動して、importを選択<br/>
<img src="http://grandbig.github.io/images/start-spring-boot3.png" alt="import" /></p>

<p>2．importしたいDirectoryを選択<br/>
<img src="http://grandbig.github.io/images/start-spring-boot4.png" alt="Directoryの選択" /></p>

<p>3．Createの方を選択<br/>
<img src="http://grandbig.github.io/images/start-spring-boot5.png" alt="Createの方を選択" /></p>

<p>4．Project名と保存場所を確認<br/>
<img src="http://grandbig.github.io/images/start-spring-boot6.png" alt="Project名と保存場所を確認" /></p>

<p>5．流れに任せてNextを続ける<br/>
<img src="http://grandbig.github.io/images/start-spring-boot7.png" alt="ソースファイル一覧" /></p>

<p><img src="http://grandbig.github.io/images/start-spring-boot8.png" alt="ライブラリの確認" /></p>

<p><img src="http://grandbig.github.io/images/start-spring-boot9.png" alt="ライブラリの確認" /></p>

<p><img src="http://grandbig.github.io/images/start-spring-boot10.png" alt="JDKを選択" /></p>

<p>6．一通り作業が終わったらFinishを選択<br/>
<img src="http://grandbig.github.io/images/start-spring-boot11.png" alt="Finishを選択" /></p>

<p>7．Intellij IDEAのターミナルで<code>gradle bootRun</code>を実行<br/>
<img src="http://grandbig.github.io/images/start-spring-boot12.png" alt="コマンドを実行" /></p>

<p>続いて、最も簡単なIntelliJ IDEA上での実行が完了しました。</p>

<p>引き続きSpring Bootを見ていきますが、本記事は一旦ここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PromiseKitを使ってみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/09/swift-promisekit/"/>
    <updated>2016-04-09T23:07:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/09/swift-promisekit</id>
    <content type="html"><![CDATA[<h4>SwiftでPromiseライブラリを使ってみよう</h4>

<p>さて、前回から引き続きSwiftでのPromiseライブラリについて見ていきたいと思います。<br/>
今回はPromiseライブラリのSwift界隈で有名な <strong>PromiseKit</strong> について見ていきます。</p>

<h4>PromiseKitのインストール</h4>

<p>早速、 <strong>PromiseKit</strong> の導入について紹介します。<br/>
筆者の場合、Xcode7.3を利用しているため、Swift2.2を扱うことになります。<br/>
<a href="https://github.com/mxcl/PromiseKit">GitHub</a>で紹介されている下記の導入方法では <strong>2.2.1</strong> がインストールされます。<br/>
しかし、このバージョンはSwift2.2に対応していないため、エラーが発生します。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">use_frameworks</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="n">pod</span> <span class="s">&quot;PromiseKit&quot;</span><span class="p">,</span> <span class="s">&quot;~&gt;2.0&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://promisekit.org/">PromiseKitの公式ドキュメントページ</a>を見ると、Newsの項目でバージョン <strong>3.1.0</strong> でSwift2.2に対応したと書かれています。<br/>
そこで、今回は、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">use_frameworks</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="n">pod</span> <span class="s">&quot;PromiseKit&quot;</span><span class="p">,</span> <span class="s">&quot;3.1.0&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>とすることで、Xcode7.3でも問題なく、PromiseKitを扱えるようにしました。</p>

<h4>PromiseKitで非同期処理を直列に書いてみよう</h4>

<p>前回のBrightFutureで紹介した処理をPromiseKitで書いてみようと思います。<br/>
まずは、非同期処理をPromiseKitを使って定義します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">func</span> <span class="n">p</span><span class="p">(</span><span class="nl">msg:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">let</span> <span class="n">promise</span> <span class="o">=</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="p">{</span> <span class="p">(</span><span class="n">fulfill</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="k">in</span>
</span><span class='line'>      <span class="n">let</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>          <span class="n">dispatch_sync</span><span class="p">(</span><span class="n">dispatch_get_main_queue</span><span class="p">(),</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>              <span class="n">fulfill</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>          <span class="p">})</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>                                                  
</span><span class='line'>  <span class="k">return</span> <span class="n">promise</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>では、これを呼び出してみましょう。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">p</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">).</span><span class="n">then</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="k">in</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">p</span><span class="p">(</span><span class="s">&quot;Good Evening&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}.</span><span class="n">then</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="k">in</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">p</span><span class="p">(</span><span class="s">&quot;Good Bye&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ネストが浅い状態で複数の非同期処理を書くことができました。<br/>
また、BrightFutureと大きな違いはなく書くことできました。</p>

<h4>PromiseKitで非同期処理を並列に書いてみよう</h4>

<p>続いて、複数の非同期処理を並列に実行する場合を考えてみます。<br/>
順番に処理をする必要がなく、処理が完了したものから反映していきたい場合などに使いますね。</p>

<p>非同期処理自体は先程と同じものを使います。<br/>
では、並列に処理を呼び出してみましょう。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// 実行したい非同期処理を定義</span>
</span><span class='line'><span class="n">let</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">p_promiseKit</span><span class="p">(</span><span class="s">&quot;Method1&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">let</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">p_promiseKit</span><span class="p">(</span><span class="s">&quot;Method2&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">let</span> <span class="n">p3</span> <span class="o">=</span> <span class="n">ps</span><span class="p">.</span><span class="n">p_promiseKit</span><span class="p">(</span><span class="s">&quot;Method3&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// まとめて非同期処理を実行</span>
</span><span class='line'><span class="n">when</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">]).</span><span class="n">then</span> <span class="p">{</span> <span class="p">(</span><span class="nl">result:</span> <span class="p">[</span><span class="n">String</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AnyPromise</span> <span class="k">in</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">AnyPromise</span><span class="p">(</span><span class="nl">bound:</span> <span class="n">Promise</span><span class="p">())</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>先に書いた直列処理では、1秒間隔でログが出力されたかと思います。<br/>
ここでは同時に実行したため、ほぼ同時に3つのログが出力されたはずです。</p>

<p>さて如何だったでしょうか？<br/>
SwiftでもPromiseライブラリはたくさん出てきました。<br/>
<a href="https://github.com/Thomvis/BrightFutures">BrightFuture</a>, <a href="https://github.com/mxcl/PromiseKit">PromiseKit</a>, <a href="https://github.com/ReactKit/SwiftTask">SwiftTask</a>のいずれを利用するかは開発者の判断になるかと思います。<br/>
個人的にはPromiseKitはGitHub上に似た名称のブランチがたくさんあるのをどうにかして欲しいなと思ってたりします笑</p>

<p>また、時間があるときにPromiseを使って何かやりたいと思います。<br/>
と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[BrightFutureを使ってみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/04/03/bright-future/"/>
    <updated>2016-04-03T17:11:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/04/03/bright-future</id>
    <content type="html"><![CDATA[<h4>SwiftでPromiseライブラリを使ってみよう</h4>

<p>最近は更新頻度が落ちてしまっていますが、久々に更新します。<br/>
(iPhoneSEが発表されたことですし笑)</p>

<p>さて、本日はSwift版Promiseライブラリとしては割と有名な <strong>BrightFuture</strong> ライブラリを使ってみたいと思います。<br/>
筆者は、新しいことに取り組む際は、JSで例を見た方がわかりやすかったりするので、Node.jsのPromiseと交えながら紹介していきたいと思います。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>Promiseとは</h4>

<p>まずは、Promiseの存在について軽く触れておきます。<br/>
<a href="http://azu.github.io/promises-book/">JS Promiseの本</a>によると、Promiseとは『非同期処理を抽象化したオブジェクトとそれを操作する仕組み』のことだそうです。<br/>
これだけ読むと理解しがたいと思うので、筆者が感じるPromiseの良さをざっくり書くと&hellip;</p>

<ul>
<li>非同期処理を繰り返す場合でも、深いネストにならない</li>
<li>非同期処理を繰り返す場合でも、見かけ上、直列的に処理を書ける</li>
</ul>


<p>ということにつきると思います。</p>

<p>具体的な例については、Node.jsで説明します。</p>

<h4>Node.jsでのPromiseの例</h4>

<p>早速、見ていきます。<br/>
Node.jsで非同期処理を定義する場合、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// 非同期処理を持ったメソッド</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">p</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">callback</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>となります。<br/>
このメソッドを繰り返し実行する場合、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">p</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg1</span> <span class="o">+</span> <span class="s2">&quot;, date: &quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'>  <span class="nx">p</span><span class="p">(</span><span class="s2">&quot;Good Evening&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg2</span> <span class="o">+</span> <span class="s2">&quot;, date: &quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'>      <span class="nx">p</span><span class="p">(</span><span class="s2">&quot;Good Bye&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg3</span> <span class="o">+</span> <span class="s2">&quot;, date: &quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>のようになります。<br/>
ネスト深いですね&hellip;。</p>

<p>これをPromiseを用いて書き直してみましょう。<br/>
まずはメソッドの定義にPromiseを適用します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">p</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">resolve</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
</span><span class='line'>      <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>こうすることで、呼び出し側で下記のように浅いネストで書くことができます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">p</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">msg1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg1</span> <span class="o">+</span> <span class="s2">&quot;, date: &quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">p</span><span class="p">(</span><span class="s2">&quot;Good Evening&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">msg2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg2</span> <span class="o">+</span> <span class="s2">&quot;, date: &quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">p</span><span class="p">(</span><span class="s2">&quot;Good Bye&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">msg3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg3</span> <span class="o">+</span> <span class="s2">&quot;, date: &quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>うむ。かなり浅くなりましたね。<br/>
これをSwiftで書くとどうなるのでしょうか？</p>

<h4>SwiftでのPromiseの例</h4>

<p>Swiftでも非同期処理を定義する場合、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">func</span> <span class="nf">p</span><span class="p">(</span><span class="nl">msg:</span> <span class="n">String</span><span class="p">,</span> <span class="nl">closure:</span> <span class="p">(</span><span class="n">String</span> <span class="o">-&gt;</span> <span class="p">()))</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">let</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="n">dispatch_sync</span><span class="p">(</span><span class="n">dispatch_get_main_queue</span><span class="p">(),</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">closure</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>のように書けたりします。<br/>
これを複数回呼び出す場合、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">p</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg1</span><span class="p">)</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">msg1</span> <span class="o">+</span> <span class="s">&quot;, date: \(NSDate())&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">p</span><span class="p">(</span><span class="s">&quot;Good Evening&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg2</span><span class="p">)</span> <span class="k">in</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="n">msg2</span> <span class="o">+</span> <span class="s">&quot;, date: \(NSDate())&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="n">p</span><span class="p">(</span><span class="s">&quot;Good Bye&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg3</span><span class="p">)</span> <span class="k">in</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">msg3</span> <span class="o">+</span> <span class="s">&quot;, date: \(NSDate())&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>のようになります。<br/>
同様にネストが深くなりますね&hellip;。</p>

<p>では、Promiseでネストを改善しましょう。<br/>
Swiftでは、OSSの<a href="https://github.com/Thomvis/BrightFutures">BrightFuture</a>を利用します。<br/>
導入はいつも通りCocoaPodsを使いました。</p>

<p>1． Podfileに下記を記載</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">source</span> <span class="err">&#39;</span><span class="nl">https:</span><span class="c1">//github.com/CocoaPods/Specs.git&#39;</span>
</span><span class='line'><span class="n">platform</span> <span class="o">:</span><span class="n">ios</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">8.0</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">use_frameworks</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="n">pod</span> <span class="err">&#39;</span><span class="n">BrightFutures</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>2．<code>pod install</code>を実行</p>

<p>導入が完了したら、処理を書き換えていきます。<br/>
メソッドにPromiseを適用しましょう。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">func</span> <span class="n">p_future</span><span class="p">(</span><span class="nl">msg:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Future</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">NoError</span><span class="o">&gt;</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">let</span> <span class="n">promise</span> <span class="o">=</span> <span class="n">Promise</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">NoError</span><span class="o">&gt;</span><span class="p">()</span>
</span><span class='line'>  <span class="n">let</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="n">dispatch_sync</span><span class="p">(</span><span class="n">dispatch_get_main_queue</span><span class="p">(),</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">promise</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>  
</span><span class='line'>  <span class="k">return</span> <span class="n">promise</span><span class="p">.</span><span class="n">future</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>これを呼び出すときは下記のように書けます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">p_future</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">).</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">msg1</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">msg1</span> <span class="o">+</span> <span class="s">&quot;, date: \(NSDate())&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">p_future</span><span class="p">(</span><span class="s">&quot;Good Evening&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">msg2</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">msg2</span> <span class="o">+</span> <span class="s">&quot;, date: \(NSDate())&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">p_future</span><span class="p">(</span><span class="s">&quot;Good Bye&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}.</span><span class="n">onSuccess</span> <span class="p">{</span> <span class="p">(</span><span class="n">msg3</span><span class="p">)</span> <span class="k">in</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">msg3</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ネストが浅くなりましたね。<br/>
こうして比較してみると、Node.jsとSwiftで呼び出し側の書き方はかなり似ていますね。<br/>
Swiftだけを眺めてみてもよくわからないという方はNode.jsの方も見てみると良いと思います。</p>

<p>今回はかなり基本的な例を書かせて頂きましたが、参考になれば幸いです。<br/>
といったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Network Link Conditionerを使ってみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/03/24/network-link-conditioner/"/>
    <updated>2016-03-24T21:17:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/03/24/network-link-conditioner</id>
    <content type="html"><![CDATA[<h4>iPhoneシミュレータで速度制限してみよう！</h4>

<p>少し間が空きましたが、ブログを更新します。<br/>
本日は <strong>iPhoneシミュレータで速度制限する方法</strong> を見ていきたいと思います。<br/>
と言うのも、筆者はこれまでシミュレータでの開発をあまりやったことがありませんでした。<br/>
なぜなら開発端末のスペックが基本的にギリギリだったからです&hellip;。</p>

<p>少しでも開発端末のメモリ消費量を減らすために実機での開発をしてきました。<br/>
しかし、『手元に実機がある環境というのも実は贅沢なのでは？』と思い直し、<br/>
今更ではありますが、本日のお題に行き着いたわけです。</p>

<p>では早速見ていきましょう。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>Network Link Conditionerをインストールする</h4>

<p>iPhoneシミュレータには実機と違って、速度制限する機能が設定アプリ内にありません。<br/>
なので、Appleが提供している <strong>Network Link Conditioner</strong> ツールをインストールします。</p>

<p>0．Apple Developerサイトにサインイン<br/>
まずは、<a href="https://developer.apple.com/downloads/">Apple Developerサイト</a>にアクセスしましょう。<br/>
開発者IDでサインインしていない場合、下記のようなサインイン画面にリダイレクトされます。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner1.png" alt="Apple Developer Sign in" /></p>

<p>サインイン後、Download画面には飛ばずに、別画面にリダイレクトされます。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner2.png" alt="Apple Top Page" /></p>

<p>1．<a href="https://developer.apple.com/downloads/">Apple Downloadサイト</a>に遷移してダウンロード<br/>
サインインが完了していれば当初の目的のDownloadサイトに問題なくアクセスできます。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner3.png" alt="Download Page" /></p>

<p>2．Network Link Conditioerをインストール<br/>
続いて、インストールした <strong>Hardware IO Tools</strong> の中から <strong>Network Link Conditioner</strong> をダブルクリックしましょう。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner4.png" alt="Network Link Conditionerをインストール" /></p>

<p>※ 全てのユーザに対してインストールするか聞かれますが、もちろんOKにしましょう！<br/>
(でないと、先に進めないので&hellip;)</p>

<p>3．Network Link Conditionerを起動<br/>
インストール後、 <strong>Network Link Conditioner</strong> が自動的に起動します。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner5.png" alt="Network Link Conditioner" /></p>

<p>4．通信速度を設定<br/>
これで速度制限が設定できるようになったので、早速設定します。<br/>
と言っても実に簡単で <strong>Profile</strong> から該当する通信形式を選択して左下のスイッチをONにするだけです。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner6.png" alt="通信速度の選択" /></p>

<p>上手を見て分かる通り、<br/>
100% Loss, 3G, DSL, Edge, High Latency DNS, Very Bad Network, Wifi<br/>
から選択できます。</p>

<p>それぞれの意味は下記のようなイメージでしょうか。</p>

<ul>
<li>100% Loss: Packetが全てロスするので、何も通信できません</li>
<li>3G: モバイル端末での3G通信</li>
<li>DSL: アナログ回線による通信方式(有名なのはADSL)</li>
<li>Edge: 広い意味での3Gの1つだが、2.75Gとも言われる</li>
<li>High Latency DNS: DNSサーバ側のDelayを想定</li>
<li>Very Bad Network: 非常に通信状態が悪い</li>
<li>Wifi: Wifi環境</li>
</ul>


<p>今や、都内では3G環境を探す方がたいへんだったりしますが、<br/>
通信状態が悪いところでの実験は必要不可欠だと思います。</p>

<p>因みに、2回目以降はシステム環境設定から <strong>Network Link Conditioner</strong> の起動が可能です。</p>

<p><img src="http://grandbig.github.io/images/network-link-conditioner7.png" alt="システム環境設定から起動" /></p>

<p>ぜひ試してみてください。<br/>
と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SwiftでTupleを活用しよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/03/12/swift-tuple/"/>
    <updated>2016-03-12T23:09:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/03/12/swift-tuple</id>
    <content type="html"><![CDATA[<h4>Tupleとは</h4>

<p>さて、本日はSwiftの <strong>Tuple</strong> について見ていきます。<br/>
<strong>Tuple</strong> とは『複数の型の値を一組にまとめる』ときに利用します。</p>

<p>続いて具体的な使い方を紹介します。</p>

<h5>valueのみの格納</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">sample</span> <span class="o">=</span> <span class="p">(</span><span class="mi">201603</span><span class="p">,</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="s">&quot;0番目の値は\(sample.0), 1番目の値は\(sample.1), 2番目の値は\(sample.2)&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>これを実行すると、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="mi">0</span><span class="err">番目の値は</span><span class="mi">201603</span><span class="p">,</span> <span class="mi">1</span><span class="err">番目の値は</span><span class="n">TEST</span><span class="p">,</span> <span class="mi">2</span><span class="err">番目の値は</span><span class="n">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>のように出力されます。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h5>key, valueの格納</h5>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">sample</span> <span class="o">=</span> <span class="p">(</span><span class="nl">num:</span> <span class="mi">201603</span><span class="p">,</span> <span class="nl">str:</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="nl">flag:</span> <span class="n">true</span><span class="p">)</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="s">&quot;0番目の値は\(sample.num)&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="err">番目の値は\</span><span class="p">(</span><span class="n">sample</span><span class="p">.</span><span class="n">str</span><span class="p">),</span> <span class="mi">2</span><span class="err">番目の値は\</span><span class="p">(</span><span class="n">sample</span><span class="p">.</span><span class="n">flag</span><span class="p">))</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="s">&quot;0番目の値は\(sample.0), 1番目の値は\(sample.1), 2番目の値は\(sample.2)&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>これを実行すると、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="mi">0</span><span class="err">番目の値は</span><span class="mi">201603</span><span class="p">,</span> <span class="mi">1</span><span class="err">番目の値は</span><span class="n">TEST</span><span class="p">,</span> <span class="mi">2</span><span class="err">番目の値は</span><span class="n">true</span>
</span><span class='line'><span class="mi">0</span><span class="err">番目の値は</span><span class="mi">201603</span><span class="p">,</span> <span class="mi">1</span><span class="err">番目の値は</span><span class="n">TEST</span><span class="p">,</span> <span class="mi">2</span><span class="err">番目の値は</span><span class="n">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>のように出力されます。<br/>
key, valueの関係で書いても、数値指定が可能です。</p>

<p>数値指定ができることから、部分的にkeyを指定することができます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">let</span> <span class="n">sample</span> <span class="o">=</span> <span class="p">(</span><span class="mi">201603</span><span class="p">,</span> <span class="nl">str:</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="nl">flag:</span> <span class="n">true</span><span class="p">)</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="s">&quot;0番目の値は\(sampel.0), 1番目の値は\(sample.str), 2番目の値は\(sample.flag)&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>これを実行すると、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="mi">0</span><span class="err">番目の値は</span><span class="mi">201603</span><span class="p">,</span> <span class="mi">1</span><span class="err">番目の値は</span><span class="n">TEST</span><span class="p">,</span> <span class="mi">2</span><span class="err">番目の値は</span><span class="n">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>と出力されます。</p>

<h4>TupleとArray, Dictionaryの違いは？</h4>

<p><strong>Tuple</strong> が真新しく見えるかというと実はそうでもないというのが筆者の感想でありました。<br/>
というのも、ここまでの話では『ArrayやDictionaryで代用できるのでは？』と思えたためです。</p>

<p>それぞれ比較してみましょう。</p>

<h5>TupleとArrayを比較</h5>

<p>まずは、 <strong>Tuple</strong> とArrayの比較です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// Array</span>
</span><span class='line'><span class="n">let</span> <span class="n">arraySample</span> <span class="o">=</span> <span class="p">[</span><span class="mi">201603</span><span class="p">,</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="n">true</span><span class="p">]</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">arraySample</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Tuple</span>
</span><span class='line'><span class="n">let</span> <span class="n">tupleSample</span> <span class="o">=</span> <span class="p">(</span><span class="mi">201603</span><span class="p">,</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">tupleSample</span><span class="mf">.0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>2つの違い

<ul>
<li>書式が異なる(Tupleの方が簡易)</li>
<li>Arrayは要素の追加と削除が可能だが、Tupleはできない</li>
</ul>
</li>
<li>2つの同じところ

<ul>
<li>異なる型の値を格納できる(Arrayは<code>AnyObject</code>にすれば良い)</li>
<li>値渡し</li>
</ul>
</li>
</ul>


<h5>TupleとDictionaryを比較</h5>

<p>次に、 <strong>Tuple</strong> とDictionaryの比較です。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// Dictionary</span>
</span><span class='line'><span class="n">let</span> <span class="n">dictSample</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;numValue&quot;</span><span class="o">:</span> <span class="mi">201603</span><span class="p">,</span> <span class="s">&quot;strValue&quot;</span><span class="o">:</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="s">&quot;flagValue&quot;</span><span class="o">:</span> <span class="n">true</span><span class="p">]</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">dictSample</span><span class="p">[</span><span class="s">&quot;numValue&quot;</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Tuple</span>
</span><span class='line'><span class="n">let</span> <span class="n">tupleSample</span> <span class="o">=</span> <span class="p">(</span><span class="nl">numValue:</span> <span class="mi">201603</span><span class="p">,</span> <span class="nl">strValue:</span> <span class="s">&quot;TEST&quot;</span><span class="p">,</span> <span class="nl">flagValue:</span> <span class="n">true</span><span class="p">)</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">tupleSample</span><span class="p">.</span><span class="n">numValue</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Tuple</strong> とDictionaryの違いと同一点はArrayと比較した場合と同じです。</p>

<ul>
<li>2つの違い

<ul>
<li>書式が異なる(Tupleの方が簡易)</li>
<li>Dictionaryは要素の追加と削除が可能だが、Tupleはできない</li>
</ul>
</li>
<li>2つの同じところ

<ul>
<li>異なる型の値を格納できる(DictionaryはValueを<code>AnyObject</code>にすれば良い)</li>
<li>値渡し</li>
</ul>
</li>
</ul>


<h4>まとめ</h4>

<p>正直、『こういったところでは  <strong>Tuple</strong> を必ず利用したい』という利用シーンがあまり思い浮かびません&hellip;。<br/>
書式が簡単でとっつきやすいという良さはあるかもしれませんが、<br/>
実際に利用した際にその本当の意義を感じることができるのかもしれませんね。</p>

<p>と言ったところで、本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[今更だけど使ってみようSwiftyJson]]></title>
    <link href="http://grandbig.github.io/blog/2016/03/06/swiftyjson/"/>
    <updated>2016-03-06T22:34:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/03/06/swiftyjson</id>
    <content type="html"><![CDATA[<h4>SwiftyJsonの便利さを改めて確かめてみる</h4>

<p>さて、筆者の個人的な諸事情により、なかなか時間が取れないため、<br/>
完全に新しいことを書けないでいる今日このごろです。<br/>
今更ながら書くか否か迷ったのですが、<br/>
折角、習慣化しているブログ投稿をSTOPさせたくもないので、<br/>
Swift屋にとっては当たり前となっているであろう<a href="https://github.com/SwiftyJSON/SwiftyJSON">SwiftyJson</a>について書こうと思います。<br/>
何を隠そう、筆者は今までSwiftyJsonの存在は把握していたものの、<br/>
自身で変換して書くことに拘っていたので触っていませんでした。<br/>
がしかし、食わず嫌いは如何なものかということで触ってみることにしました。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>CocoaPodsでインストール</h4>

<p>まずは、インストールです。<br/>
<code>CocoaPods</code>, <code>Carthage</code>, <code>Swift Package Manager</code>に対応した良心的なライブラリです。<br/>
筆者はいつも通り<code>CocoaPods</code>を使います。<br/>
今回も<code>Open Weather Map API</code>をサンプルに利用したいので<a href="https://github.com/Alamofire/Alamofire">Alamofire</a>も合わせてインストールします。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">platform</span> <span class="o">:</span><span class="n">ios</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">8.0</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">use_frameworks</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="err">&#39;</span><span class="n">SwiftyJsonSample</span><span class="err">&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">Alamofire</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">~&gt;</span> <span class="mf">3.0</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="n">pod</span> <span class="err">&#39;</span><span class="n">SwiftyJSON</span><span class="err">&#39;</span><span class="p">,</span> <span class="o">:</span><span class="n">git</span> <span class="o">=&gt;</span> <span class="err">&#39;</span><span class="nl">https:</span><span class="c1">//github.com/SwiftyJSON/SwiftyJSON.git&#39;</span>
</span><span class='line'><span class="n">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>SwiftyJsonで何が便利になったのか</h4>

<p>さて、早速、<code>SwiftyJson</code>を使うことで何が便利になるのか見てみたいと思います。<br/>
まずは、便利にする前のベースのコードをご覧下さい。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">value</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">value</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="nl">weatherArray:</span><span class="n">AnyObject</span><span class="o">?</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">weather</span> <span class="o">=</span> <span class="n">weatherArray</span><span class="o">?</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[</span><span class="s">&quot;description&quot;</span><span class="p">]</span> <span class="n">as</span><span class="o">?</span> <span class="n">String</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>前回の記事で紹介した<code>guard statement</code>を使うことでネストが浅くなっていますね。<br/>
これはわかりやすさのために、バラけて書いたのですが、<br/>
元々 <strong>description</strong> の値が欲しいのであれば、</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">value</span><span class="o">?</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">]</span><span class="o">??</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;description&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="o">!</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>とすればかなり短く書けます。<br/>
しかしながら、素人にとって <strong>オプショナル型</strong> や <strong>アンラップ</strong> は相当わかりにくいと言えます。<br/>
これが<code>SwiftyJson</code>を利用することで細かい上記のことを気にすることなく、<br/>
WEBで扱うようにJSONを扱えます。<br/>
もちろんSwiftでは重要なことなので、<br/>
<a href="http://qiita.com/maiki055/items/b24378a3707bd35a31a8">どこよりも分かりやすいSwiftの&#8221;?&ldquo;と&rdquo;!&#8221;</a>を参考に正しく理解しましょう。</p>

<p>さて、<code>SwiftyJson</code>を使うと次のように書けます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">value</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">let</span> <span class="n">json</span> <span class="o">=</span> <span class="n">JSON</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;description&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>多少行数は増えているものの、<br/>
<strong>オプショナル型</strong> の <strong>アンラップ化</strong> を気にせず書けていることがわかると思います。<br/>
そう、まるでWEBでJSONを扱うかのように&hellip;。</p>

<p>オプショナル型の値が内部にオプショナル型の値を持っているなど、<br/>
<code>??</code>と書く状況を作りかねないことがあっても<code>SwiftyJson</code>では考えなくて良いんですね。<br/>
う〜ん。便利。</p>

<p>他にもたくさんの使い道があるため機会があれば積極的に利活用していこうと思います。<br/>
また、これまでスルーしてきた他の便利ライブラリについてもちょくちょくその便利さを追求していこうと思います。</p>

<p>と言ったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Swift2.0で追加された新機能を見てみよう！]]></title>
    <link href="http://grandbig.github.io/blog/2016/02/29/swift-2-new-function/"/>
    <updated>2016-02-29T21:38:00+09:00</updated>
    <id>http://grandbig.github.io/blog/2016/02/29/swift-2-new-function</id>
    <content type="html"><![CDATA[<h4>今更だけど見てみたいSwift2.0で追加された新機能</h4>

<p>さて、本日は表題通り、今更なんだけど&hellip;Swift2.0で追加された新機能について見ていきたいと思います。<br/>
Swift2.0では下記3つの新機能が追加されました。</p>

<ul>
<li><code>guard statement</code></li>
<li><code>do-catch</code>, <code>try</code>, <code>defer</code></li>
<li><code>Protocol Extension</code></li>
</ul>


<p>これらの使いどころやメリットなど見ていきたいと思います。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>




<!-- more -->


<h4>guard statementについて</h4>

<p>まずは<code>guard statement</code>について見ていきます。</p>

<h5>用途について</h5>

<p>条件分岐(<code>if 〜 else 〜</code>)で利用します。<br/>
例えば、Open Weather Map APIでのリクエストでは</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">value</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">value</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="nl">weatherArray:</span><span class="n">AnyObject</span><span class="o">?</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">weather</span> <span class="o">=</span> <span class="n">weatherArray</span><span class="o">?</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="n">guard</span> <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[</span><span class="s">&quot;description&quot;</span><span class="p">]</span> <span class="n">as</span><span class="o">?</span> <span class="n">String</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// 値の取得に失敗した場合</span>
</span><span class='line'>              <span class="k">return</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>のように書くことができます。<br/>
以前であれば、下記のようにこれでもかってくらいネストしていたのですが、可読性が向上します。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">Alamofire</span><span class="p">.</span><span class="n">request</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span> <span class="s">&quot;http://api.openweathermap.org/data/2.5/weather?APPID=&lt;あなた自身のAPPID&gt;&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nl">parameters:</span><span class="p">[</span><span class="s">&quot;q&quot;</span><span class="o">:</span><span class="n">location</span><span class="p">]).</span><span class="n">responseJSON</span> <span class="p">{</span> <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Void</span> <span class="k">in</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">isSuccess</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">if</span> <span class="n">let</span> <span class="n">value</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">value</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="n">let</span> <span class="n">weatherArray</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s">&quot;weather&quot;</span><span class="p">]</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">if</span> <span class="n">let</span> <span class="n">weather</span> <span class="o">=</span> <span class="n">weatherArray</span><span class="o">?</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">{</span>
</span><span class='line'>                      <span class="k">if</span> <span class="n">let</span> <span class="n">description</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[</span><span class="s">&quot;description&quot;</span><span class="p">]</span> <span class="n">as</span><span class="o">?</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>                          <span class="n">print</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">}</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>do-catch, try, deferについて</h4>

<p>続いて、<code>do-catch</code>, <code>try</code>, <code>defer</code>について見ていきます。</p>

<h5>用途について</h5>

<p>基本的には、例外処理を実行したい場合に使います。<br/>
想定外の例外が発生した場合にアプリが落ちないようにしないことはもちろんのこと、<br/>
想定した例外処理が発生した場合にもそれ相応の処理を実施することがあるので、<br/>
そういったときに使います。</p>

<p>まずは、呼び出し元を書きます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// エラー種別の設定</span>
</span><span class='line'><span class="k">enum</span> <span class="nl">MyError:</span> <span class="n">ErrorType</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">case</span> <span class="n">NilError</span>
</span><span class='line'>  <span class="k">case</span> <span class="n">StringError</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// サンプルメソッド</span>
</span><span class='line'><span class="n">func</span> <span class="n">sampleMethod</span><span class="p">(</span><span class="nl">param:</span> <span class="n">String</span><span class="o">?</span><span class="p">)</span> <span class="n">throws</span> <span class="o">-&gt;</span> <span class="n">String</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">defer</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="s">&quot;メソッドが呼ばれました！&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="nb">nil</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">throw</span> <span class="n">MyError</span><span class="p">.</span><span class="n">NilError</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s">&quot;Error&quot;</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">throw</span> <span class="n">MyError</span><span class="p">.</span><span class="n">StringError</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="n">param</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>throw</code>で例外を投げる際にエラー種別を渡す必要があるため、エラー種別を設定します。<br/>
<code>defer</code>は例外発生の有無に関わらず、 <strong>必ず実行する処理内容</strong> を書きます。</p>

<p>続いて、呼び出し先を書きます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">do</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">let</span> <span class="n">result</span> <span class="o">=</span> <span class="n">try</span> <span class="n">self</span><span class="p">.</span><span class="n">sampleThrowMethod</span><span class="p">(</span><span class="s">&quot;Error&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span> <span class="n">catch</span> <span class="n">MyError</span><span class="p">.</span><span class="n">NilError</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="s">&quot;nilがパラメータとして渡されました&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span> <span class="n">catch</span> <span class="n">MyError</span><span class="p">.</span><span class="n">StringError</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="s">&quot;Error文字列がパラメータとして渡されました&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span> <span class="n">catch</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">print</span><span class="p">(</span><span class="s">&quot;想定外のErrorが発生しました&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>do-catch</code>は例外発生別にその後の処理を分けるために利用します。<br/>
<code>try!</code>で強制実行する場合は<code>do-catch</code>は不要ですが、<br/>
アプリがダウンしては元も子もないのでオススメしません。</p>

<h4>Protocol Extension</h4>

<p>最後に<code>Protocol Extension</code>です。</p>

<h5>用途について</h5>

<p>筆者のイメージではObjective-Cで言うところの <strong>カテゴリ</strong> の用途に近いのかなと思っています。<br/>
Objective-Cのカテゴリと異なるのは指定した既存クラスにメソッドを追加するのではなく、<br/>
<strong>プロトコル</strong> にメソッドを追加するので拡張性や柔軟性が高いようです。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// MyProtocol.swift</span>
</span><span class='line'><span class="n">protocol</span> <span class="n">MyProtocol</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">func</span> <span class="n">pico</span><span class="p">()</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">extension</span> <span class="n">MyProtocol</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">func</span> <span class="n">pico</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">print</span><span class="p">(</span><span class="s">&quot;プロトコルメソッドを追加しました&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>定義したメソッドを下記のように呼び出せます。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// ViewController.swift</span>
</span><span class='line'><span class="n">class</span> <span class="nl">ViewController:</span> <span class="n">UIViewController</span><span class="p">,</span> <span class="n">MyProtocol</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">override</span> <span class="n">func</span> <span class="n">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">super</span><span class="p">.</span><span class="n">viewDidLoad</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">self</span><span class="p">.</span><span class="n">pico</span><span class="p">()</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>まとめ</h4>

<p>さて如何でしたでしょうか？<br/>
今更ですが、Swift2.0の新機能について見てきました。<br/>
個人的には<code>guard statement</code>はかなり利用したいなと思っています。<br/>
ネストが多発しがちなSwiftでは活躍の場面が目に浮かびます。<br/>
<code>do-catch</code>は待ち望んだ機能ですし、逆に今までなかったのが信じられないくらいですよね？<br/>
より安定したSwift製アプリを作成することができると想像するとワクワクしますね。</p>

<p>といったところで本日はここまで。</p>

<script async src="http://grandbig.github.io//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


<p><ins class="adsbygoogle"style="display:inline-block;width:320px;height:100px"data-ad-client="ca-pub-2881241309408290"data-ad-slot="6603059167"></ins></p>

<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

]]></content>
  </entry>
  
</feed>
